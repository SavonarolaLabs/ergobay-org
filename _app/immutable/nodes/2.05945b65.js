var ps=Object.defineProperty;var ms=(t,e,n)=>e in t?ps(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var v=(t,e,n)=>(ms(t,typeof e!="symbol"?e+"":e,n),n),pn=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var T=(t,e,n)=>(pn(t,e,"read from private field"),n?n.call(t):e.get(t)),J=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},R=(t,e,n,r)=>(pn(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var ne=(t,e,n,r)=>({set _(s){R(t,e,s,n)},get _(){return T(t,e,r)}});import{s as We,n as be,r as lr,j as Ge,o as ys}from"../chunks/scheduler.71af12de.js";import{S as qe,i as Xe,g as S,s as G,m as N,h as A,j as O,f as x,c as F,n as M,A as bt,k as B,l as sn,a as te,y as b,F as $t,x as Qe,G as rt,o as le,H as cr,e as Ot,d as ie,p as ar,b as ur,t as ae,r as Ye,u as et,v as tt,w as nt}from"../chunks/index.b4fc6cc3.js";import{e as ce,s as hr,a as Wt,b as mn,c as yn,w as _s,i as It,D as bs,C as ws,f as vs,l as xs,g as Ts}from"../chunks/notifier.478fc9c7.js";function Be(t,e){if(t)return;let n;switch(typeof e){case"string":n=new Error(e);break;case"function":n=new Error(e());break;default:n=e}throw n}function Is(t,e){const n=typeof t;if(n!==e)throw new Error(`Expected an object of type '${e}', got '${n}'.`)}var Es=t=>Object.prototype.toString.call(t);function ks(t){if(t===null)return"null";const e=typeof t;return e==="object"||e==="function"?Es(t).slice(8,-1):e}function Bs(t,e){if(!(t instanceof e))throw new Error(`Expected an instance of '${e.name}', got '${ks(t)}'.`)}function dr(t){return t?Array.isArray(t)?t.length===0:Object.keys(t).length===0:!0}function Pt(t){if(t)return Be(t.length>0,"Empty array."),t[0]}function Ss(t){if(t)return Be(t.length>0,"Empty array."),As(t,-1)}function As(t,e){const n=t==null?void 0:t.length;if(n)return e<0&&(e+=n),t[e]}var ke=BigInt(0),qt=BigInt(1),fr=BigInt(7);BigInt(10);var Cs=BigInt(63),gr=BigInt(127),$s=BigInt(128);function pr(t){return typeof t=="bigint"?t:BigInt(t)}function _e(t,e){if(t)return;let n;switch(typeof e){case"string":n=new Error(e);break;case"function":n=new Error(e());break;default:n=e}throw n}function mr(t,e){const n=typeof t;if(n!==e)throw new Error(`Expected an object of type '${e}', got '${n}'.`)}var Os=t=>Object.prototype.toString.call(t);function Ps(t){if(t===null)return"null";const e=typeof t;return e==="object"||e==="function"?Os(t).slice(8,-1):e}function on(t,e){if(!(t instanceof e))throw new Error(`Expected an instance of '${e.name}', got '${Ps(t)}'.`)}function ue(t){return t?Array.isArray(t)?t.length===0:Object.keys(t).length===0:!0}function W(t){return!ue(t)}function Z(t){return t==null||Number.isNaN(t)}function H(t){return!Z(t)}function Ve(t){if(t)return _e(t.length>0,"Empty array."),t[0]}function Hs(t){if(t)return _e(t.length>0,"Empty array."),Ls(t,-1)}function Ls(t,e){const n=t==null?void 0:t.length;if(n)return e<0&&(e+=n),t[e]}function zs(t,e){return t.some((n,r)=>t.findIndex(s=>e(s)===e(n))!==r)}function Us(t,e){if(t.length<=e)return[t];const n=[];for(let r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}function Vs(t,e,n="asc"){return[...t].sort((r,s)=>e(r)>e(s)?n==="asc"?1:-1:e(r)<e(s)?n==="asc"?-1:1:0)}function Rs(t,e){if(t===e)return!0;if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function _n(t,e){if(t===e)return!0;if(e.length>t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ds(t,e){if(t===e)return!0;if(e.length>t.length)return!1;const n=t.length-e.length;for(let r=e.length-1;r>=0;r--)if(e[r]!==t[r+n])return!1;return!0}var P=BigInt(0),Ht=BigInt(1),yr=BigInt(7);BigInt(10);var Ns=BigInt(63),_r=BigInt(127),br=BigInt(128);function K(t){return typeof t=="bigint"?t:BigInt(t)}function Xt(t,e,n){let r=P;if(ue(t))return r;for(const s of t)(Z(n)||n(s))&&(r+=e(s));return r}var Ze="nanoErgs";function Se(t,e){const n={};for(const r of t)if((Z(e)||e===Ze)&&(n[Ze]=(n[Ze]||P)+K(r.value)),e!==Ze)for(const s of r.assets)H(e)&&e!==s.tokenId||(n[s.tokenId]=(n[s.tokenId]||P)+K(s.amount));return H(e)?n[e]||P:{nanoErgs:n[Ze]||P,tokens:Object.keys(n).filter(r=>r!==Ze).map(r=>({tokenId:r,amount:n[r]}))}}function Et(t,e){var s;Array.isArray(t)&&(t=Se(t)),Array.isArray(e)&&(e=Se(e));const n=[],r=t.nanoErgs-e.nanoErgs;for(const o of t.tokens){const i=o.amount-(((s=e.tokens.find(l=>l.tokenId===o.tokenId))==null?void 0:s.amount)||P);i!==P&&n.push({tokenId:o.tokenId,amount:i})}return{nanoErgs:r,tokens:n}}var bn=4,Ms=9;function js(t){let e=0;for(let n=bn;n<=Ms;n++){const r=`R${n}`;if(t[r]){if(n===bn){e=n;continue}if(n-e>1)return!1;e=n}}return!0}function Gs(t){const e={};for(const n in t){const r=t[n];Z(r)||(e[n]=r)}return e}function vt(...t){const e=new Uint8Array(t.reduce((r,s)=>r+s.length,0));let n=0;for(const r of t)on(r,Uint8Array),e.set(r,n),n+=r.length;return e}function wr(t){return!t||t.length%2?!1:(t.startsWith("0x")||(t="0x"+t),!isNaN(Number(t)))}function lt(t){return t.length/2}var Ut=(t=>(t[t.Mainnet=0]="Mainnet",t[t.Testnet=16]="Testnet",t))(Ut||{}),oe=(t=>(t[t.P2PK=1]="P2PK",t[t.P2SH=2]="P2SH",t[t.P2S=3]="P2S",t))(oe||{}),wn={sizeInclusion:8,constantSegregation:16},ln=class{constructor(){v(this,"_items");this._items=[]}_isIndexOutOfBounds(t){return t<0||t>=this._items.length}[Symbol.iterator](){let t=0;return{next:()=>({done:t>=this.length,value:this._items[t++]})}}get length(){return this._items.length}get isEmpty(){return this.length===0}at(t){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);return this._items[t]}add(t,e){return this._addOneOrMore(t,e)}_addOne(t,e){if(H(e)&&H(e.index)){if(e.index===this.length)return this._items.push(this._map(t)),this.length;if(this._isIndexOutOfBounds(e.index))throw new RangeError(`Index '${e.index}' is out of range.`);return this._items.splice(e.index,0,this._map(t)),this.length}return this._items.push(this._map(t)),this._items.length}_addOneOrMore(t,e){if(Array.isArray(t)){H(e)&&H(e.index)&&(t=t.reverse());for(const n of t)this._addOne(n,e)}else this._addOne(t,e);return this.length}toArray(){return[...this._items]}reduce(t,e){return this._items.reduce(t,e)}};/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Fs=t=>t instanceof Uint8Array,Lt=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Rt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),de=(t,e)=>t<<32-e|t>>>e,Qs=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Qs)throw new Error("Non little-endian hardware is not supported");function Ks(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ke(t){if(typeof t=="string"&&(t=Ks(t)),!Fs(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}let vr=class{clone(){return this._cloneInto()}};function Ws(t){const e=r=>t().update(Ke(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function qs(t){const e=(r,s)=>t(s).update(Ke(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function Dt(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Xs(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function zt(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function xr(t,e){Xs(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const Zs=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3]);class Js extends vr{constructor(e,n,r={},s,o,i){if(super(),this.blockLen=e,this.outputLen=n,this.length=0,this.pos=0,this.finished=!1,this.destroyed=!1,Dt(e),Dt(n),Dt(s),n<0||n>s)throw new Error("outputLen bigger than keyLen");if(r.key!==void 0&&(r.key.length<1||r.key.length>s))throw new Error(`key must be up 1..${s} byte long or undefined`);if(r.salt!==void 0&&r.salt.length!==o)throw new Error(`salt must be ${o} byte long or undefined`);if(r.personalization!==void 0&&r.personalization.length!==i)throw new Error(`personalization must be ${i} byte long or undefined`);this.buffer32=Lt(this.buffer=new Uint8Array(e))}update(e){zt(this);const{blockLen:n,buffer:r,buffer32:s}=this;e=Ke(e);const o=e.length,i=e.byteOffset,l=e.buffer;for(let c=0;c<o;){this.pos===n&&(this.compress(s,0,!1),this.pos=0);const a=Math.min(n-this.pos,o-c),h=i+c;if(a===n&&!(h%4)&&c+a<o){const u=new Uint32Array(l,h,Math.floor((o-c)/4));for(let g=0;c+n<o;g+=s.length,c+=n)this.length+=n,this.compress(u,g,!1);continue}r.set(e.subarray(c,c+a),this.pos),this.pos+=a,this.length+=a,c+=a}return this}digestInto(e){zt(this),xr(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,this.buffer.subarray(n).fill(0),this.compress(r,0,!0);const s=Lt(e);this.get().forEach((o,i)=>s[i]=o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:o,outputLen:i,pos:l}=this;return e||(e=new this.constructor({dkLen:i})),e.set(...this.get()),e.length=r,e.finished=s,e.destroyed=o,e.outputLen=i,e.buffer.set(n),e.pos=l,e}}const xt=BigInt(2**32-1),Zt=BigInt(32);function Tr(t,e=!1){return e?{h:Number(t&xt),l:Number(t>>Zt&xt)}:{h:Number(t>>Zt&xt)|0,l:Number(t&xt)|0}}function Ys(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:o,l:i}=Tr(t[s],e);[n[s],r[s]]=[o,i]}return[n,r]}const ei=(t,e)=>BigInt(t>>>0)<<Zt|BigInt(e>>>0),ti=(t,e,n)=>t>>>n,ni=(t,e,n)=>t<<32-n|e>>>n,ri=(t,e,n)=>t>>>n|e<<32-n,si=(t,e,n)=>t<<32-n|e>>>n,ii=(t,e,n)=>t<<64-n|e>>>n-32,oi=(t,e,n)=>t>>>n-32|e<<64-n,li=(t,e)=>e,ci=(t,e)=>t,ai=(t,e,n)=>t<<n|e>>>32-n,ui=(t,e,n)=>e<<n|t>>>32-n,hi=(t,e,n)=>e<<n-32|t>>>64-n,di=(t,e,n)=>t<<n-32|e>>>64-n;function fi(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const gi=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),pi=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,mi=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),yi=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,_i=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),bi=(t,e,n,r,s,o)=>e+n+r+s+o+(t/2**32|0)|0,wi={fromBig:Tr,split:Ys,toBig:ei,shrSH:ti,shrSL:ni,rotrSH:ri,rotrSL:si,rotrBH:ii,rotrBL:oi,rotr32H:li,rotr32L:ci,rotlSH:ai,rotlSL:ui,rotlBH:hi,rotlBL:di,add:fi,add3L:gi,add3H:pi,add4L:mi,add4H:yi,add5H:bi,add5L:_i},ee=wi,j=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),_=new Uint32Array(32);function $e(t,e,n,r,s,o){const i=s[o],l=s[o+1];let c=_[2*t],a=_[2*t+1],h=_[2*e],u=_[2*e+1],g=_[2*n],d=_[2*n+1],p=_[2*r],f=_[2*r+1],w=ee.add3L(c,h,i);a=ee.add3H(w,a,u,l),c=w|0,{Dh:f,Dl:p}={Dh:f^a,Dl:p^c},{Dh:f,Dl:p}={Dh:ee.rotr32H(f,p),Dl:ee.rotr32L(f,p)},{h:d,l:g}=ee.add(d,g,f,p),{Bh:u,Bl:h}={Bh:u^d,Bl:h^g},{Bh:u,Bl:h}={Bh:ee.rotrSH(u,h,24),Bl:ee.rotrSL(u,h,24)},_[2*t]=c,_[2*t+1]=a,_[2*e]=h,_[2*e+1]=u,_[2*n]=g,_[2*n+1]=d,_[2*r]=p,_[2*r+1]=f}function Oe(t,e,n,r,s,o){const i=s[o],l=s[o+1];let c=_[2*t],a=_[2*t+1],h=_[2*e],u=_[2*e+1],g=_[2*n],d=_[2*n+1],p=_[2*r],f=_[2*r+1],w=ee.add3L(c,h,i);a=ee.add3H(w,a,u,l),c=w|0,{Dh:f,Dl:p}={Dh:f^a,Dl:p^c},{Dh:f,Dl:p}={Dh:ee.rotrSH(f,p,16),Dl:ee.rotrSL(f,p,16)},{h:d,l:g}=ee.add(d,g,f,p),{Bh:u,Bl:h}={Bh:u^d,Bl:h^g},{Bh:u,Bl:h}={Bh:ee.rotrBH(u,h,63),Bl:ee.rotrBL(u,h,63)},_[2*t]=c,_[2*t+1]=a,_[2*e]=h,_[2*e+1]=u,_[2*n]=g,_[2*n+1]=d,_[2*r]=p,_[2*r+1]=f}class vi extends Js{constructor(e={}){super(128,e.dkLen===void 0?64:e.dkLen,e,64,16,16),this.v0l=j[0]|0,this.v0h=j[1]|0,this.v1l=j[2]|0,this.v1h=j[3]|0,this.v2l=j[4]|0,this.v2h=j[5]|0,this.v3l=j[6]|0,this.v3h=j[7]|0,this.v4l=j[8]|0,this.v4h=j[9]|0,this.v5l=j[10]|0,this.v5h=j[11]|0,this.v6l=j[12]|0,this.v6h=j[13]|0,this.v7l=j[14]|0,this.v7h=j[15]|0;const n=e.key?e.key.length:0;if(this.v0l^=this.outputLen|n<<8|65536|1<<24,e.salt){const r=Lt(Ke(e.salt));this.v4l^=r[0],this.v4h^=r[1],this.v5l^=r[2],this.v5h^=r[3]}if(e.personalization){const r=Lt(Ke(e.personalization));this.v6l^=r[0],this.v6h^=r[1],this.v7l^=r[2],this.v7h^=r[3]}if(e.key){const r=new Uint8Array(this.blockLen);r.set(Ke(e.key)),this.update(r)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:o,v2h:i,v3l:l,v3h:c,v4l:a,v4h:h,v5l:u,v5h:g,v6l:d,v6h:p,v7l:f,v7h:w}=this;return[e,n,r,s,o,i,l,c,a,h,u,g,d,p,f,w]}set(e,n,r,s,o,i,l,c,a,h,u,g,d,p,f,w){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=o|0,this.v2h=i|0,this.v3l=l|0,this.v3h=c|0,this.v4l=a|0,this.v4h=h|0,this.v5l=u|0,this.v5h=g|0,this.v6l=d|0,this.v6h=p|0,this.v7l=f|0,this.v7h=w|0}compress(e,n,r){this.get().forEach((c,a)=>_[a]=c),_.set(j,16);let{h:s,l:o}=ee.fromBig(BigInt(this.length));_[24]=j[8]^o,_[25]=j[9]^s,r&&(_[28]=~_[28],_[29]=~_[29]);let i=0;const l=Zs;for(let c=0;c<12;c++)$e(0,4,8,12,e,n+2*l[i++]),Oe(0,4,8,12,e,n+2*l[i++]),$e(1,5,9,13,e,n+2*l[i++]),Oe(1,5,9,13,e,n+2*l[i++]),$e(2,6,10,14,e,n+2*l[i++]),Oe(2,6,10,14,e,n+2*l[i++]),$e(3,7,11,15,e,n+2*l[i++]),Oe(3,7,11,15,e,n+2*l[i++]),$e(0,5,10,15,e,n+2*l[i++]),Oe(0,5,10,15,e,n+2*l[i++]),$e(1,6,11,12,e,n+2*l[i++]),Oe(1,6,11,12,e,n+2*l[i++]),$e(2,7,8,13,e,n+2*l[i++]),Oe(2,7,8,13,e,n+2*l[i++]),$e(3,4,9,14,e,n+2*l[i++]),Oe(3,4,9,14,e,n+2*l[i++]);this.v0l^=_[0]^_[16],this.v0h^=_[1]^_[17],this.v1l^=_[2]^_[18],this.v1h^=_[3]^_[19],this.v2l^=_[4]^_[20],this.v2h^=_[5]^_[21],this.v3l^=_[6]^_[22],this.v3h^=_[7]^_[23],this.v4l^=_[8]^_[24],this.v4h^=_[9]^_[25],this.v5l^=_[10]^_[26],this.v5h^=_[11]^_[27],this.v6l^=_[12]^_[28],this.v6h^=_[13]^_[29],this.v7l^=_[14]^_[30],this.v7h^=_[15]^_[31],_.fill(0)}destroy(){this.destroyed=!0,this.buffer32.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const xi=qs(t=>new vi(t));function Ti(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),l=Number(n&o),c=r?4:0,a=r?0:4;t.setUint32(e+c,i,r),t.setUint32(e+a,l,r)}let Ii=class extends vr{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Rt(this.buffer)}update(e){zt(this);const{view:n,buffer:r,blockLen:s}=this;e=Ke(e);const o=e.length;for(let i=0;i<o;){const l=Math.min(s-this.pos,o-i);if(l===s){const c=Rt(e);for(;s<=o-i;i+=s)this.process(c,i);continue}r.set(e.subarray(i,i+l),this.pos),this.pos+=l,i+=l,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){zt(this),xr(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let u=i;u<s;u++)n[u]=0;Ti(r,s-8,BigInt(this.length*8),o),this.process(r,0);const l=Rt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=c/4,h=this.get();if(a>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)l.setUint32(4*u,h[u],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:l}=this;return e.length=s,e.pos=l,e.finished=o,e.destroyed=i,s%n&&e.buffer.set(r),e}};const Ei=(t,e,n)=>t&e^~t&n,ki=(t,e,n)=>t&e^t&n^e&n,Bi=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Pe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),He=new Uint32Array(64);let Si=class extends Ii{constructor(){super(64,32,8,!1),this.A=Pe[0]|0,this.B=Pe[1]|0,this.C=Pe[2]|0,this.D=Pe[3]|0,this.E=Pe[4]|0,this.F=Pe[5]|0,this.G=Pe[6]|0,this.H=Pe[7]|0}get(){const{A:e,B:n,C:r,D:s,E:o,F:i,G:l,H:c}=this;return[e,n,r,s,o,i,l,c]}set(e,n,r,s,o,i,l,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=l|0,this.H=c|0}process(e,n){for(let u=0;u<16;u++,n+=4)He[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const g=He[u-15],d=He[u-2],p=de(g,7)^de(g,18)^g>>>3,f=de(d,17)^de(d,19)^d>>>10;He[u]=f+He[u-7]+p+He[u-16]|0}let{A:r,B:s,C:o,D:i,E:l,F:c,G:a,H:h}=this;for(let u=0;u<64;u++){const g=de(l,6)^de(l,11)^de(l,25),d=h+g+Ei(l,c,a)+Bi[u]+He[u]|0,f=(de(r,2)^de(r,13)^de(r,22))+ki(r,s,o)|0;h=a,a=c,c=l,l=i+d|0,i=o,o=s,s=r,r=d+f|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,l=l+this.E|0,c=c+this.F|0,a=a+this.G|0,h=h+this.H|0,this.set(r,s,o,i,l,c,a,h)}roundClean(){He.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Ai=Ws(()=>new Si);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ir(...t){const e=(s,o)=>i=>s(o(i)),n=Array.from(t).reverse().reduce((s,o)=>s?e(s,o.encode):o.encode,void 0),r=t.reduce((s,o)=>s?e(s,o.decode):o.decode,void 0);return{encode:n,decode:r}}function Ci(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(n=>{if(n<0||n>=t.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${t.length})`);return t[n]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(n=>{if(typeof n!="string")throw new Error(`alphabet.decode: not string element=${n}`);const r=t.indexOf(n);if(r===-1)throw new Error(`Unknown letter: "${n}". Allowed: ${t}`);return r})}}}function $i(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let n of e)if(typeof n!="string")throw new Error(`join.encode: non-string input=${n}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function vn(t,e,n){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let r=0;const s=[],o=Array.from(t);for(o.forEach(i=>{if(i<0||i>=e)throw new Error(`Wrong integer: ${i}`)});;){let i=0,l=!0;for(let c=r;c<o.length;c++){const a=o[c],h=e*i+a;if(!Number.isSafeInteger(h)||e*i/e!==i||h-a!==e*i)throw new Error("convertRadix: carry overflow");i=h%n;const u=Math.floor(h/n);if(o[c]=u,!Number.isSafeInteger(u)||u*n+i!==h)throw new Error("convertRadix: carry overflow");if(l)u?l=!1:r=c;else continue}if(s.push(i),l)break}for(let i=0;i<t.length-1&&t[i]===0;i++)s.push(0);return s.reverse()}function Oi(t){return{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return vn(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(vn(e,t,2**8))}}}function Pi(t,e){if(typeof e!="function")throw new Error("checksum fn should be function");return{encode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=e(n).slice(0,t),s=new Uint8Array(n.length+t);return s.set(n),s.set(r,n.length),s},decode(n){if(!(n instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-t),s=e(r).slice(0,t),o=n.slice(-t);for(let i=0;i<t;i++)if(s[i]!==o[i])throw new Error("Invalid checksum");return r}}}const Hi=t=>Ir(Oi(58),Ci(t),$i("")),Er=Hi("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),kr=t=>Ir(Pi(4,e=>t(t(e))),Er);var Li=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function zi(t){on(t,Uint8Array);let e="";for(let n=0,r=t.length;n<r;n++)e+=Li[t[n]];return e}function Ui(t){mr(t,"string"),_e(t.length%2===0,"Invalid hex padding.");const e=new Uint8Array(t.length/2);for(let n=0,r=0,s=e.length;n<s;n++){const o=xn(t.charCodeAt(r++)),i=xn(t.charCodeAt(r++));e[n]=o*16+i}return e}function xn(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-(65-10);if(t>=97&&t<=102)return t-(97-10);throw new Error("Invalid byte sequence.")}var Q={encode:zi,decode:Ui};function Vi(t){return on(t,Uint8Array),new TextDecoder().decode(t)}function Ri(t){return mr(t,"string"),new Uint8Array(new TextEncoder().encode(t))}var Nt={encode:Vi,decode:Ri};kr(Di);var st=Er;function Br(t){return t instanceof Uint8Array?t:Q.decode(t)}function ct(t){return xi(Br(t),{dkLen:32})}function Di(t){return Ai(Br(t))}function Ni(t){t.length%2&&(t="0"+t);const e=BigInt("0x"+t);return 128&parseInt(t.slice(0,2),16)?-Sr(e):e}function Mi(t){const e=t>=P;e||(t=Sr(t));let n=t.toString(16);return n.length%2&&(n="0"+n),e&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Sr(t){const e=t<P;e&&(t=-t);const n=t.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:e&&Ve(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const o=(1n<<BigInt(r))-1n;return(~t&o)+1n}function ji(t,e){if(e===0)return t.write(0);if(e<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=e&127;e>>=7,e>0&&(n|=128),t.write(n)}while(e>0);return t}function Mt(t){if(t.isEmpty)return 0;let e=0,n=0,r=0;do r=t.readByte(),e|=(r&127)<<n,n+=7;while(r&128);return e}function Gi(t,e){if(e===P)return t.write(0);if(e<P)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(e&_r);e>>=yr,e>0&&(n|=128),t.write(n)}while(e>0);return t}function Fi(t){if(t.isEmpty)return P;let e=P,n=P,r=P;do r=BigInt(t.readByte()),e|=(r&_r)<<n,n+=yr;while((r&br)!=P);return e}function Y(t){let e=0;if(typeof t=="number"){do e++,t=Math.floor(t/128);while(t>0);return e}t=K(t);do e++,t/=br;while(t>P);return e}function Qi(t){return t<<1^t>>63}function Ki(t){return t>>1^-(t&1)}function Wi(t){return t<<Ht^t>>Ns}function qi(t){return t>>Ht^-(t&Ht)}var xe,me,tr,Xi=(tr=class{constructor(e){J(this,xe,void 0);J(this,me,void 0);typeof e=="string"?R(this,xe,Q.decode(e)):R(this,xe,e),R(this,me,0)}get isEmpty(){return ue(T(this,xe))}readBoolean(){return this.readByte()===1}readBits(e){const n=new Array(e);let r=0;for(let s=0;s<e;s++){const o=T(this,xe)[T(this,me)]>>r++&1;n[s]=o===1,r==8&&(r=0,ne(this,me)._++)}return r>0&&ne(this,me)._++,n}readByte(){return T(this,xe)[ne(this,me)._++]}readBytes(e){return T(this,xe).subarray(T(this,me),R(this,me,T(this,me)+e))}readVlq(){return Mt(this)}readShort(){return Number(Ki(Mt(this)))}readInt(){const e=this.readLong();return Number(e)}readLong(){return qi(Fi(this))}readBigInt(){const e=Mt(this);return Ni(Q.encode(this.readBytes(e)))}},xe=new WeakMap,me=new WeakMap,tr),Te,re,nr,cn=(nr=class{constructor(e){J(this,Te,void 0);J(this,re,void 0);R(this,Te,new Uint8Array(e)),R(this,re,0)}get length(){return T(this,re)}writeBoolean(e){return this.write(e===!0?1:0),this}writeVLQ(e){return ji(this,e)}writeBigVLQ(e){return Gi(this,e)}writeShort(e){return this.writeVLQ(Qi(e)),this}writeInt(e){return this.writeLong(BigInt(e)),this}writeLong(e){return this.writeBigVLQ(Wi(e)),this}write(e){return T(this,Te)[ne(this,re)._++]=e,this}writeBytes(e){return T(this,Te).set(e,T(this,re)),R(this,re,T(this,re)+e.length),this}writeHex(e){return this.writeBytes(Q.decode(e))}writeBits(e){let n=0;for(let r=0;r<e.length;r++)e[r]?T(this,Te)[T(this,re)]|=1<<n++:T(this,Te)[T(this,re)]&=~(1<<n++),n==8&&(n=0,ne(this,re)._++);return n>0&&ne(this,re)._++,this}writeBigInt(e){const n=Mi(e);return this.writeVLQ(n.length/2),this.writeHex(n),this}toHex(){return Q.encode(this.toBytes())}toBytes(){return T(this,Te).subarray(0,T(this,re))}},Te=new WeakMap,re=new WeakMap,nr),Ar=class{coerce(e){return e}},Cr=class extends Ar{get embeddable(){return!1}},Re=class extends Cr{get embeddable(){return!0}},ht,rr,$r=(rr=class extends Ar{constructor(n){super();J(this,ht,void 0);R(this,ht,n)}get elementsType(){return T(this,ht)}get embeddable(){return!1}},ht=new WeakMap,rr),Or=class extends Re{get code(){return 1}toString(){return"SBool"}},Pr=class extends Re{get code(){return 2}toString(){return"SByte"}},Hr=class extends Re{get code(){return 3}toString(){return"SShort"}},Lr=class extends Re{get code(){return 4}toString(){return"SInt"}},zr=class extends Re{get code(){return 5}coerce(e){return K(e)}toString(){return"SLong"}},Ur=class extends Re{get code(){return 6}coerce(e){return K(e)}toString(){return"SBigInt"}},Vr=class extends Re{get code(){return 7}coerce(e){return typeof e=="string"?Q.decode(e):e}toString(){return"SGroupElement"}},Rr=class extends Re{get code(){return 8}toString(){return"SSigmaProp"}},Dr=class extends Cr{get code(){return 98}toString(){return"SUnit"}},q=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),Nr=11,Jt=Nr+1,ge=t=>Jt*t,Zi=Object.freeze({code:ge(q.simpleColl),embeddable:!1,simpleCollTypeCode:ge(q.simpleColl),nestedCollTypeCode:ge(q.nestedColl)}),Ji=Object.freeze({code:ge(q.pairOne),embeddable:!1,pairOneTypeCode:ge(q.pairOne),pairTwoTypeCode:ge(q.pairTwo),tripleTypeCode:ge(q.pairTwo),symmetricPairTypeCode:ge(q.symmetricPair),quadrupleTypeCode:ge(q.symmetricPair),genericTupleTypeCode:ge(q.genericTuple)}),m={bool:new Or,byte:new Pr,short:new Hr,int:new Lr,long:new zr,bigInt:new Ur,groupElement:new Vr,sigmaProp:new Rr,unit:new Dr,coll:Zi,tuple:Ji};function Yt(t){return t.code>=m.coll.simpleCollTypeCode&&t.code<=m.coll.nestedCollTypeCode+Nr}function Mr(t){return t.code>=m.tuple.pairOneTypeCode&&t.code<=m.tuple.genericTupleTypeCode}function Ne(t){switch(t){case m.bool.code:return m.bool;case m.byte.code:return m.byte;case m.short.code:return m.short;case m.int.code:return m.int;case m.long.code:return m.long;case m.bigInt.code:return m.bigInt;case m.groupElement.code:return m.groupElement;case m.sigmaProp.code:return m.sigmaProp;default:throw new Error(`The type code '0x${t.toString(16)}' is not a valid primitive type code.`)}}var kt=class extends $r{get code(){return m.coll.code}coerce(e){return this.elementsType.code===m.byte.code&&!(e instanceof Uint8Array)?typeof e=="string"?Q.decode(e):Uint8Array.from(e):e.map(n=>this.elementsType.coerce(n))}toString(){return`SColl[${this.elementsType.toString()}]`}},it=class extends $r{get code(){return m.tuple.code}coerce(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=this.elementsType[r].coerce(e[r]);return n}toString(){return`(${this.elementsType.map(e=>e.toString()).join(", ")})`}};function Ae(t,e,n){return new Proxy(t,{apply:(r,s,o)=>{const i=e??new r;return!n&&ue(o)?i:new at(i,...o)}})}function jr(t,e){return new Proxy(t,{apply:e})}var jt=Ae(Pr,m.byte);Ae(Or,m.bool);Ae(Hr,m.short);Ae(Lr,m.int);Ae(zr,m.long);Ae(Ur,m.bigInt);Ae(Vr,m.groupElement);Ae(Rr,m.sigmaProp);Ae(Dr,void 0,!0);var Gt=jr(kt,(t,e,n)=>{const[r,s]=n,o=r();return s?new at(new t(o),s):()=>new t(o)});jr(it,(t,e,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new t([r(),s()]);if(r instanceof at&&s instanceof at)return new at(new t([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var Yi=33,Tn=205,In=class Bt{static serialize(e,n,r){if(n.embeddable)switch(n.code){case m.bool.code:return r.writeBoolean(e);case m.byte.code:return r.write(e);case m.short.code:return r.writeShort(e);case m.int.code:return r.writeInt(e);case m.long.code:return r.writeLong(e);case m.bigInt.code:return r.writeBigInt(e);case m.groupElement.code:return r.writeBytes(e);case m.sigmaProp.code:{const s=e;if(s.type===m.groupElement)return r.write(Tn),Bt.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(Yt(n)){if(n.elementsType.code===m.byte.code){const s=e instanceof Uint8Array;_e(s,`SColl[Byte] expected an UInt8Array, got ${typeof e}.`)}else _e(Array.isArray(e),`SColl expected an array, got ${typeof e}.`);switch(r.writeVLQ(e.length),n.elementsType.code){case m.bool.code:return r.writeBits(e);case m.byte.code:return r.writeBytes(e);default:{for(let s=0;s<e.length;s++)Bt.serialize(e[s],n.elementsType,r);return r}}}else if(Mr(n)){_e(Array.isArray(e),`STupleType serialization expected an array, got ${typeof e}.`);const s=n.elementsType.length;for(let o=0;o<s;o++)Bt.serialize(e[o],n.elementsType[o],r);return r}else if(n.code===m.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(e,n){if(e.embeddable)switch(e.code){case m.bool.code:return n.readBoolean();case m.byte.code:return n.readByte();case m.short.code:return n.readShort();case m.int.code:return n.readInt();case m.long.code:return n.readLong();case m.bigInt.code:return n.readBigInt();case m.groupElement.code:return n.readBytes(Yi);case m.sigmaProp.code:{if(n.readByte()===Tn)return this.deserialize(m.groupElement,n);break}}else switch(e.code){case m.coll.code:{const r=n.readVlq(),s=e.elementsType;switch(s.code){case m.bool.code:return n.readBits(r);case m.byte.code:return n.readBytes(r);default:{const o=new Array(r);for(let i=0;i<r;i++)o[i]=this.deserialize(s,n);return o}}}case m.tuple.code:return e.elementsType.map(r=>this.deserialize(r,n));case m.unit.code:return}throw new Error(`Parsing error: '0x${e.code.toString(16)}' type not implemented.`)}},En=class{static serialize(e,n){if(e.embeddable)n.write(e.code);else if(e.code===m.unit.code)n.write(e.code);else if(Yt(e))if(e.elementsType.embeddable)n.write(m.coll.simpleCollTypeCode+e.elementsType.code);else if(Yt(e.elementsType)){const r=e.elementsType;r.elementsType.embeddable?n.write(m.coll.nestedCollTypeCode+r.elementsType.code):(n.write(m.coll.simpleCollTypeCode),this.serialize(r,n))}else n.write(m.coll.simpleCollTypeCode),this.serialize(e.elementsType,n);else if(Mr(e)){switch(e.elementsType.length){case 2:{const r=Ve(e.elementsType),s=Hs(e.elementsType);r.embeddable?r.code===s.code?n.write(m.tuple.symmetricPairTypeCode+r.code):(n.write(m.tuple.pairOneTypeCode+r.code),this.serialize(s,n)):s.embeddable?(n.write(m.tuple.pairTwoTypeCode+s.code),this.serialize(r,n)):(n.write(m.tuple.pairOneTypeCode),this.serialize(r,n),this.serialize(s,n));return}case 3:n.write(m.tuple.tripleTypeCode);break;case 4:n.write(m.tuple.quadrupleTypeCode);break;default:{const r=e.elementsType.length;_e(r>=2&&r<=255,"Invalid type: tuples must have between 2 and 255 items."),n.write(m.tuple.genericTupleTypeCode),n.writeVLQ(r)}}for(let r=0;r<e.elementsType.length;r++)this.serialize(e.elementsType[r],n)}else throw new Error("Serialization error: type not implemented.")}static deserialize(e){const n=e.readByte();if(_e(n>0,`Parsing Error: Unexpected type code '0x${n.toString(16)}'`),n<m.tuple.genericTupleTypeCode){const r=Math.floor(n/Jt),s=Math.floor(n%Jt);switch(r){case q.embeddable:return Ne(s);case q.simpleColl:{const o=s===0?this.deserialize(e):Ne(s);return new kt(o)}case q.nestedColl:return new kt(new kt(Ne(s)));case q.pairOne:{const o=s===0?[this.deserialize(e),this.deserialize(e)]:[Ne(s),this.deserialize(e)];return new it(o)}case q.pairTwo:{const o=s===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[this.deserialize(e),Ne(s)];return new it(o)}case q.symmetricPair:{const o=s===0?[this.deserialize(e),this.deserialize(e),this.deserialize(e),this.deserialize(e)]:[Ne(s),Ne(s)];return new it(o)}}}else switch(n){case m.tuple.genericTupleTypeCode:{const r=e.readVlq(),s=new Array(r);for(let o=0;o<r;o++)s[o]=this.deserialize(e);return new it(s)}case m.unit.code:return m.unit}throw new Error("Not implemented.")}},eo=4096,dt,ft,gt,at=(gt=class{constructor(e,n){J(this,dt,void 0);J(this,ft,void 0);R(this,dt,e),R(this,ft,e.coerce(n))}static from(e){_e(e.length>0,"Empty constant bytes.");const n=new Xi(e),r=En.deserialize(n),s=In.deserialize(r,n);return new gt(r,s)}get type(){return T(this,dt)}get data(){return T(this,ft)}toBytes(){const e=new cn(eo);return En.serialize(this.type,e),In.serialize(this.data,this.type,e),e.toBytes()}toHex(){return Q.encode(this.toBytes())}},dt=new WeakMap,ft=new WeakMap,gt),to=65535;function Gr(t,e,n){if(e||(e=new cn(5e4)),e.writeBigVLQ(K(t.value)),e.writeHex(t.ergoTree),e.writeVLQ(t.creationHeight),no(e,t.assets,n),ro(e,t.additionalRegisters),H(n))return e;if(!Fr(t))throw new Error("Invalid box type.");return e.writeHex(t.transactionId).writeVLQ(t.index)}function Fr(t){const e=t;return H(e.transactionId)&&H(e.index)}function no(t,e,n){if(ue(e)){t.write(0);return}t.writeVLQ(e.length),W(n)?e.map(r=>t.writeVLQ(n.indexOf(r.tokenId)).writeBigVLQ(K(r.amount))):e.map(r=>t.writeHex(r.tokenId).writeBigVLQ(K(r.amount)))}function ro(t,e){const n=Object.keys(e).sort();let r=0;for(const s of n)e[s]&&r++;if(t.writeVLQ(r),r!=0)for(const s of n){const o=e[s];H(o)&&t.writeHex(o)}}function so(t,e){if(Z(t.creationHeight))throw new Error("Box size estimation error: creation height is undefined.");let n=0;n+=Y(H(e)?e:t.value),n+=lt(t.ergoTree),n+=Y(t.creationHeight),n+=Y(t.assets.length),n+=t.assets.reduce((s,o)=>s+=lt(o.tokenId)+Y(o.amount),0);let r=0;for(const s in t.additionalRegisters){const o=t.additionalRegisters[s];o&&(n+=lt(o),r++)}return n+=Y(r),n+=32,n+=Y(Fr(t)?t.index:to),n}function io(t){const e=new cn(1e5);e.writeVLQ(t.inputs.length),t.inputs.map(r=>oo(e,r)),e.writeVLQ(t.dataInputs.length),t.dataInputs.map(r=>e.writeHex(r.boxId));const n=co(t.outputs);return e.writeVLQ(n.length),n.map(r=>e.writeHex(r)),e.writeVLQ(t.outputs.length),t.outputs.map(r=>Gr(r,e,n)),e}function oo(t,e){t.writeHex(e.boxId),t.write(0),lo(t,e.extension)}function lo(t,e){const n=Object.keys(e);let r=0;for(const s of n){const o=e[s];H(o)&&r++}if(t.writeVLQ(r),r!=0)for(const s of n){const o=e[s];H(o)&&t.writeVLQ(Number(s)).writeHex(o)}}function co(t){const e=new Set;return t.flatMap(n=>n.assets.map(r=>e.add(r.tokenId))),Array.from(e)}var ao=class extends Error{constructor(){super("One or more inputs was selected more than one time by the current selection strategy.")}},uo=class extends Error{constructor(e){const n=[];if(e.nanoErgs&&n.push(kn("nanoErgs",e.nanoErgs)),W(e.tokens))for(const r of e.tokens)n.push(kn(r.tokenId,r.amount));super(`Insufficient inputs:${n.join()}`);v(this,"unreached");this.unreached=e}};function kn(t,e){return`
  > ${t}: ${e==null?void 0:e.toString()}`}var ho=class{constructor(){v(this,"_inputs")}select(t,e){this._inputs=t;let n=[];W(e.tokens)&&(n=this._selectTokens(e.tokens));const r=Xt(n,s=>s.value);if(Z(e.nanoErgs)&&ue(e.tokens)||H(e.nanoErgs)&&r<e.nanoErgs){const s=H(e.nanoErgs)?e.nanoErgs-r:void 0;n=n.concat(this._select(s))}return n}_selectTokens(t){let e=[];for(const n of t){const r=H(n.amount)?n.amount-Se(e,n.tokenId):void 0;r&&r<=P||(e=e.concat(this._select(r,n.tokenId)))}return e}_select(t,e){const n=this._inputs;let r=P,s=[];if(Z(t))e?s=n.filter(o=>o.assets.some(i=>i.tokenId===e)):s=n;else for(let o=0;o<n.length&&r<t;o++)if(e)for(const i of n[o].assets)i.tokenId===e&&(r+=i.amount,s.push(n[o]));else r+=n[o].value,s.push(n[o]);return W(s)&&(this._inputs=this._inputs.filter(o=>!s.includes(o))),s}},fo=class{constructor(t){v(this,"_selector");this._selector=t}select(t,e){return this._selector(t,e)}},go=class{constructor(t){v(this,"_inputs");v(this,"_strategy");v(this,"_ensureFilterPredicate");v(this,"_selector");v(this,"_sortDirection");v(this,"_ensureInclusionBoxIds");this._inputs=t}defineStrategy(t){return this._isISelectionStrategyImplementation(t)?this._strategy=t:this._strategy=new fo(t),this}select(t){this._strategy||(this._strategy=new ho);const e=this._deepCloneTarget(t);let n=[...this._inputs],r=[];const s=this._ensureFilterPredicate,o=this._ensureInclusionBoxIds;if(s?o?r=n.filter(l=>s(l)||o.has(l.boxId)):r=n.filter(s):o&&(r=n.filter(l=>o.has(l.boxId))),W(r)&&(n=n.filter(l=>!r.some(c=>c.boxId===l.boxId)),e.nanoErgs&&e.nanoErgs>P&&(e.nanoErgs-=Xt(r,l=>l.value)),W(e.tokens)&&r.some(l=>!ue(l.assets))))for(const l of e.tokens)l.amount&&l.amount>P&&(l.amount-=Se(r,l.tokenId));if(this._selector&&(n=Vs(n,this._selector,this._sortDirection||"asc")),r=r.concat(this._strategy.select(n,e)),zs(r,l=>l.boxId))throw new ao;const i=this._getUnreachedTargets(r,t);if(i.nanoErgs||W(i.tokens))throw new uo(i);return r}_deepCloneTarget(t){return{nanoErgs:t.nanoErgs,tokens:t.tokens?t.tokens.map(e=>({tokenId:e.tokenId,amount:e.amount})):void 0}}_getUnreachedTargets(t,e){const n={nanoErgs:void 0,tokens:void 0},r=Xt(t,s=>s.value);if(e.nanoErgs&&e.nanoErgs>r&&(n.nanoErgs=e.nanoErgs-r),ue(e.tokens))return n;for(const s of e.tokens){const o=Se(t,s.tokenId);if(s.amount&&s.amount>o){if(s.tokenId===Ve(t).boxId)continue;Z(n.tokens)&&(n.tokens=[]),n.tokens.push({tokenId:s.tokenId,amount:s.amount-o})}}return n}ensureInclusion(t){if(typeof t=="function")this._ensureFilterPredicate=t;else if(t==="all")this._ensureFilterPredicate=e=>e.value>0n;else if(Z(this._ensureInclusionBoxIds)&&(this._ensureInclusionBoxIds=new Set),Array.isArray(t))for(const e of t)this._ensureInclusionBoxIds.add(e);else this._ensureInclusionBoxIds.add(t);return this}orderBy(t,e){return this._selector=t,this._sortDirection=e,this}_isISelectionStrategyImplementation(t){return!!t.select}static buildTargetFrom(t){const e={};let n=P;for(const r of t){n+=K(r.value);for(const s of r.assets)e[s.tokenId]=(e[s.tokenId]||P)+K(s.amount)}return{nanoErgs:n,tokens:Object.keys(e).map(r=>({tokenId:r,amount:e[r]}))}}},po=class extends Error{constructor(){super("Registers should be densely packed. This means that it's not possible to use a register like 'R7' without filling 'R6', 'R5' and 'R4', for example.")}},mo=class extends Error{constructor(){super("Minting context is undefined. Transaction's inputs must be included in order to determine minting token id.")}},yo=class extends Error{constructor(){super("Creation Height is undefined.")}},_o=class extends Error{constructor(t){super(`Invalid Ergo address: ${t}`)}},Me=4,bo=32,en=Q.decode("0008cd"),wo=36,Qr=Q.decode("d40801"),St=Q.decode("00ea02d193b4cbe4e3010e040004300e18"),vo=44,Tt=24;function Bn(t){return Ve(t)&240}function Ft(t){return Ve(t)&15}function Sn(t){return typeof t=="string"?Q.decode(t):t}function xo(t){return t.length===wo&&_n(t,en)?oe.P2PK:t.length===vo&&_n(t,St)&&Ds(t,Qr)?oe.P2SH:oe.P2S}function An(t){return ue(t)||t.length!==33?!1:t[0]===2||t[0]===3}var we=class Je{constructor(e,n){v(this,"_ergoTree");v(this,"_network");v(this,"_type");this._ergoTree=e,this._network=n,this._type=xo(e)}get network(){return this._network}get ergoTree(){return Q.encode(this._ergoTree)}get type(){return this._type}static fromErgoTree(e,n){return new Je(Q.decode(e),n)}static fromPublicKey(e,n){const r=Sn(e);if(!An(r))throw new Error("The Public Key is invalid.");const s=vt(en,r);return new Je(s,n)}static fromHash(e,n){if(e=Sn(e),e.length===bo)e=e.subarray(0,Tt);else if(e.length!=Tt)throw Error(`Invalid hash length: ${e.length}`);const r=vt(St,e,Qr);return new Je(r,n)}static fromBase58(e,n=!1){const r=st.decode(e);if(!n&&!Je.validate(r))throw new _o(e);const s=Bn(r),o=Ft(r),i=r.subarray(1,r.length-Me);return o===oe.P2PK?this.fromPublicKey(i,s):o===oe.P2SH?this.fromHash(i,s):new Je(i,s)}static validate(e){const n=typeof e=="string"?st.decode(e):e;if(n.length<Me)return!1;if(Ft(n)===oe.P2PK){const l=n.subarray(1,n.length-Me);if(!An(l))return!1}const r=n.subarray(0,n.length-Me),s=n.subarray(n.length-Me,n.length),i=ct(r).subarray(0,Me);return Rs(i,s)}static getNetworkType(e){return Bn(st.decode(e))}static getAddressType(e){return Ft(st.decode(e))}getPublicKeys(){return this.type===oe.P2PK?[this._ergoTree.subarray(en.length)]:[]}toP2SH(e){if(this.type===oe.P2SH)return this.encode();const n=ct(this._ergoTree).subarray(0,Tt);return this._encode(n,oe.P2SH,e)}encode(e){let n;return this.type===oe.P2PK?n=Ve(this.getPublicKeys()):this.type===oe.P2SH?n=this._ergoTree.subarray(St.length,St.length+Tt):n=this._ergoTree,this._encode(n,this.type,e)}_encode(e,n,r){H(r)||(H(this.network)?r=this.network:r=Ut.Mainnet);const s=Uint8Array.from([r+n]);e=vt(s,e);const o=ct(e).subarray(0,Me);return st.encode(vt(e,o))}toString(e){return this.encode(e)}},To=class Kr{constructor(e){v(this,"boxId");v(this,"value");v(this,"ergoTree");v(this,"creationHeight");v(this,"assets");v(this,"additionalRegisters");v(this,"transactionId");v(this,"index");this.boxId=e.boxId,this.ergoTree=e.ergoTree,this.creationHeight=e.creationHeight,this.value=K(e.value),this.assets=e.assets.map(n=>({tokenId:n.tokenId,amount:K(n.amount)})),this.additionalRegisters=e.additionalRegisters,this.transactionId=e.transactionId,this.index=e.index}isValid(){return Kr.validate(this)}static validate(e){const n=Gr(e).toBytes(),r=Q.encode(ct(n));return e.boxId===r}},Cn=class extends To{constructor(e){super(e);v(this,"_extension");e.extension&&this.setContextVars(e.extension)}get extension(){return this._extension}setContextVars(e){return this._extension=e,this}toUnsignedInputObject(e){return{...this.toPlainObject(e),extension:this._extension||{}}}toPlainObject(e){return e==="EIP-12"?{boxId:this.boxId,value:this.value.toString(),ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:this.assets.map(n=>({tokenId:n.tokenId,amount:n.amount.toString()})),additionalRegisters:this.additionalRegisters,transactionId:this.transactionId,index:this.index}:{boxId:this.boxId}}},Io=class{constructor(t,e,n){v(this,"_inputs");v(this,"_dataInputs");v(this,"_outputs");this._inputs=Object.freeze(t),this._dataInputs=Object.freeze(e),this._outputs=Object.freeze(n)}get id(){return Q.encode(ct(this.toBytes()))}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get burning(){return Et(Se(this.inputs),Se(this.outputs))}toPlainObject(t){return{inputs:this.inputs.map(e=>e.toUnsignedInputObject(t||"default")),dataInputs:this.dataInputs.map(e=>e.toPlainObject(t||"default")),outputs:this.outputs.map(e=>Eo(e))}}toEIP12Object(){return this.toPlainObject("EIP-12")}toBytes(){return io({inputs:this.inputs.map(t=>t.toUnsignedInputObject("default")),dataInputs:this.dataInputs.map(t=>t.toPlainObject("default")),outputs:this.outputs}).toBytes()}};function Eo(t){return{...t,value:t.value.toString(),assets:t.assets.map(e=>({tokenId:e.tokenId,amount:e.amount.toString()}))}}var ko=class extends Error{constructor(t){super(`Box '${t}' is already included.`)}},Bo=class extends Error{constructor(t){super(t)}},So=class extends Error{constructor(t){super(`Invalid input: ${t}`)}},$n=class extends Error{constructor(t){super(`Malformed transaction: ${t}`)}},Ao=class extends Error{constructor(){super(`A box must contain no more than ${un} distinct tokens.`)}},Wr=class extends Error{constructor(){super("This transaction is trying to burn tokens. If that's your intention you must explicitly allow token burning on TransactionBuilder.configure() method. If no, a change address should be provided.")}},an=class extends Error{constructor(t){super(t)}},un=120,tn=class extends ln{constructor(t,e){super(),H(t)&&this.add(t,e)}_map(t){return{tokenId:t.tokenId,amount:K(t.amount)}}_addOne(t,e){if((Z(e)||e.sum&&!H(e.index))&&this._sum(this._map(t)))return this.length;if(this._items.length>=un)throw new Ao;return super._addOne(t,e),this.length}add(t,e){return super.add(t,e)}_sum(t){for(const e of this._items)if(e.tokenId===t.tokenId)return e.amount+=t.amount,!0;return!1}remove(t,e){let n=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);n=t}else if(n=this._items.findIndex(r=>r.tokenId===t),this._isIndexOutOfBounds(n))throw new an(`TokenId '${t}' not found in assets collection.`);if(e&&n>-1){const r=K(e),s=this._items[n];if(r>s.amount)throw new Bo("Insufficient token amount to perform a subtraction operation.");if(r<s.amount)return s.amount-=r,this.length}return this._items.splice(n,1),this.length}contains(t){return this._items.some(e=>e.tokenId===t)}},On=class extends ln{constructor(t){super(),H(t)&&this.add(t)}_map(t){return t instanceof Cn?t:new Cn(t)}_addOne(t){if(this._items.some(e=>e.boxId===t.boxId))throw new ko(t.boxId);return super._addOne(t)}remove(t){let e=-1;if(typeof t=="number"){if(this._isIndexOutOfBounds(t))throw new RangeError(`Index '${t}' is out of range.`);e=t}else if(e=this._items.findIndex(n=>n.boxId===t),this._isIndexOutOfBounds(e))throw new an("The input you are trying to remove is not present in the inputs collection.");return this._items.splice(e,1),this.length}},Co=class qr extends ln{constructor(e){super(),H(e)&&this.add(e)}_map(e){return e}remove(e){let n=-1;if(typeof e=="number"){if(this._isIndexOutOfBounds(e))throw new RangeError(`Index '${e}' is out of range.`);n=e}else if(n=this._items.lastIndexOf(e),this._isIndexOutOfBounds(n))throw new an("The output you are trying to remove is not present in the outputs collection.");return this._items.splice(n,1),this.length}clone(){return new qr(this._items)}sum(e){const n={};let r=P;if(e&&(e.nanoErgs&&(r=e.nanoErgs),W(e.tokens)))for(const s of e.tokens)Z(s.amount)||(n[s.tokenId]=(n[s.tokenId]||P)+s.amount);for(const s of this._items){r+=s.value;for(const o of s.assets)n[o.tokenId]=(n[o.tokenId]||P)+o.amount}return{nanoErgs:r,tokens:Object.keys(n).map(s=>({tokenId:s,amount:n[s]}))}}},$o=7,Oo=class{constructor(t){v(this,"_bytes");typeof t=="string"?this._bytes=Q.decode(t):this._bytes=t}get header(){return this._bytes[0]}get version(){return this.header&$o}get hasSegregatedConstants(){return(this.header&wn.constantSegregation)!=0}get hasSize(){return(this.header&wn.sizeInclusion)!=0}toBytes(){return this._bytes}toHex(){return Q.encode(this.toBytes())}toAddress(t=Ut.Mainnet){return we.fromErgoTree(this.toHex(),t)}},Xr=BigInt(360),hn=BigInt(1e6);function Po(t=Xr){return e=>BigInt(e.estimateSize())*t}var Fe=class{constructor(t,e,n){v(this,"_address");v(this,"_tokens");v(this,"_value");v(this,"_valueEstimator");v(this,"_creationHeight");v(this,"_registers");v(this,"_minting");this.setValue(t),this._creationHeight=n,this._tokens=new tn,this._registers={},typeof e=="string"?this._address=wr(e)?we.fromErgoTree(e):we.fromBase58(e):e instanceof Oo?this._address=e.toAddress():this._address=e}get value(){return H(this._valueEstimator)?this._valueEstimator(this):this._value}get address(){return this._address}get ergoTree(){return this._address.ergoTree}get creationHeight(){return this._creationHeight}get assets(){return this._tokens}get additionalRegisters(){return this._registers}get minting(){return this._minting}setValue(t){if(typeof t=="function")this._valueEstimator=t;else if(this._value=K(t),this._valueEstimator=void 0,this._value<=P)throw new Error("An UTxO cannot be created without a minimum required amount.");return this}addTokens(t,e){return t instanceof tn?this._tokens.add(t.toArray(),e):this._tokens.add(t,e),this}addNfts(...t){const e=t.map(n=>({tokenId:n,amount:Ht}));return this.addTokens(e)}mintToken(t){return this._minting={...t,amount:K(t.amount)},this}setCreationHeight(t,e){return(Z(e)||e.replace===!0||e.replace===!1&&Z(this._creationHeight))&&(this._creationHeight=t),this}setAdditionalRegisters(t){if(this._registers=Gs(t),!js(t))throw new po;return this}eject(t){return t({tokens:this._tokens}),this}build(t){var n;let e=this.assets.toArray();if(this.minting){if(ue(t))throw new yo;ue(this.additionalRegisters)&&this.setAdditionalRegisters({R4:Gt(jt,Nt.decode(this.minting.name||"")).toHex(),R5:Gt(jt,Nt.decode(this.minting.description||"")).toHex(),R6:Gt(jt,Nt.decode(((n=this.minting.decimals)==null?void 0:n.toString())||"0")).toHex()}),e=[{tokenId:Ve(t).boxId,amount:this.minting.amount},...e]}if(Z(this.creationHeight))throw new mo;return{value:this.value,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:e.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters}}estimateSize(t=hn){_e(!!this.creationHeight,"Creation height must be set");const e=this._tokens.toArray();this.minting&&e.push({tokenId:"0000000000000000000000000000000000000000000000000000000000000000",amount:this.minting.amount});const n={value:t,ergoTree:this.ergoTree,creationHeight:this.creationHeight,assets:e.map(r=>({tokenId:r.tokenId,amount:r.amount})),additionalRegisters:this.additionalRegisters};return so(n)}},Ho=class extends Error{constructor(t){super(t)}};function Lo(t){return{addInputs:e=>t.from(e).configureSelector(n=>n.ensureInclusion(Array.isArray(e)?e.map(r=>r.boxId):e.boxId)).inputs.length,addOutputs:(e,n)=>t.to(e,n).outputs.length,addDataInputs:(e,n)=>t.withDataFrom(e,n).dataInputs.length,burnTokens:e=>{if(!t.settings.canBurnTokensFromPlugins)throw new Wr;t.burnTokens(e)},setFee:e=>t.payFee(e)}}var zo=class{constructor(){v(this,"_maxDistinctTokensPerChangeBox");v(this,"_allowTokenBurning");v(this,"_allowTokenBurningFromPlugins");v(this,"_isolateErgOnChange");this._maxDistinctTokensPerChangeBox=un,this._allowTokenBurning=!1,this._allowTokenBurningFromPlugins=!1,this._isolateErgOnChange=!1}get maxTokensPerChangeBox(){return this._maxDistinctTokensPerChangeBox}get canBurnTokens(){return this._allowTokenBurning}get canBurnTokensFromPlugins(){return this.canBurnTokens||this._allowTokenBurningFromPlugins}get shouldIsolateErgOnChange(){return this._isolateErgOnChange}setMaxTokensPerChangeBox(t){return this._maxDistinctTokensPerChangeBox=t,this}allowTokenBurning(t=!0){return this._allowTokenBurning=t,this}allowTokenBurningFromPlugins(t=!0){return this._allowTokenBurningFromPlugins=t,this}isolateErgOnChange(t=!0){return this._isolateErgOnChange=t,this}},dn=BigInt(11e5),Uo="1005040004000e36100204a00b08cd0279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798ea02d192a39a8cc7a701730073011001020402d19683030193a38cc7b2a57300000193c2b2a57301007473027303830108cdeeac93b1a57304",Zr=class{constructor(t){v(this,"_inputs");v(this,"_dataInputs");v(this,"_outputs");v(this,"_settings");v(this,"_creationHeight");v(this,"_selectorCallbacks");v(this,"_changeAddress");v(this,"_feeAmount");v(this,"_burning");v(this,"_plugins");this._inputs=new On,this._dataInputs=new On,this._outputs=new Co,this._settings=new zo,this._creationHeight=t}get inputs(){return this._inputs}get dataInputs(){return this._dataInputs}get outputs(){return this._outputs}get changeAddress(){return this._changeAddress}get fee(){return this._feeAmount}get burning(){return this._burning}get settings(){return this._settings}get creationHeight(){return this._creationHeight}get and(){return this}from(t){return Vo(t)&&(t=t.toArray()),this._inputs.add(t),this}to(t,e){return this._outputs.add(t,e),this}withDataFrom(t,e){return this._dataInputs.add(t,e),this}sendChangeTo(t){return typeof t=="string"?this._changeAddress=wr(t)?we.fromErgoTree(t,Ut.Mainnet):we.fromBase58(t):this._changeAddress=t,this}payFee(t){return this._feeAmount=K(t),this}payMinFee(){return this.payFee(dn),this}burnTokens(t){return this._burning||(this._burning=new tn),this._burning.add(t),this}configure(t){return t(this._settings),this}configureSelector(t){return Z(this._selectorCallbacks)&&(this._selectorCallbacks=[]),this._selectorCallbacks.push(t),this}extend(t){return this._plugins||(this._plugins=[]),this._plugins.push({execute:t,pending:!0}),this}eject(t){return t({inputs:this.inputs,dataInputs:this.dataInputs,outputs:this.outputs,burning:this.burning,settings:this.settings,selection:e=>{this.configureSelector(e)}}),this}build(){if(W(this._plugins)){const i=Lo(this);for(const l of this._plugins)l.pending&&(l.execute(i),l.pending=!1)}if(this._isMinting()){if(this._isMoreThanOneTokenBeingMinted())throw new $n("only one token can be minted per transaction.");if(this._isTheSameTokenBeingMintedOutsideTheMintingBox())throw new Ho("EIP-4 tokens cannot be minted from outside of the minting box.")}this.outputs.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}));const t=this.outputs.clone();H(this._feeAmount)&&t.add(new Fe(this._feeAmount,Uo));const e=new go(this.inputs.toArray());if(W(this._selectorCallbacks))for(const i of this._selectorCallbacks)i(e);const n=W(this._burning)?t.sum({tokens:this._burning.toArray()}):t.sum();let r=e.select(n);if(H(this._changeAddress)){let i=Et(Se(r),n);const l=[];if(W(i.tokens)){let c=Pn({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});for(;c>i.nanoErgs;)r=e.select({nanoErgs:n.nanoErgs+c,tokens:n.tokens}),i=Et(Se(r),n),c=Pn({changeAddress:this._changeAddress,creationHeight:this._creationHeight,tokens:i.tokens,maxTokensPerBox:this.settings.maxTokensPerChangeBox,baseIndex:this.outputs.length+1});const a=Us(i.tokens,this._settings.maxTokensPerChangeBox);for(const h of a){const u=new Fe(Po(),this._changeAddress,this._creationHeight).addTokens(h);i.nanoErgs-=u.value,l.push(u)}}if(i.nanoErgs>P)if(W(l)){if(this.settings.shouldIsolateErgOnChange)t.add(new Fe(i.nanoErgs,this._changeAddress));else{const c=Ve(l);c.setValue(c.value+i.nanoErgs)}t.add(l)}else t.add(new Fe(i.nanoErgs,this._changeAddress))}for(const i of r)if(!i.isValid())throw new So(i.boxId);const s=new Io(r,this.dataInputs.toArray(),t.toArray().map(i=>i.setCreationHeight(this._creationHeight,{replace:!1}).build(r)));let o=s.burning;if(o.nanoErgs>P)throw new $n("it's not possible to burn ERG.");if(W(o.tokens)&&W(this._burning)&&(o=Et(o,{nanoErgs:P,tokens:this._burning.toArray()})),!this._settings.canBurnTokens&&W(o.tokens))throw new Wr;return s}_isMinting(){for(const t of this._outputs)if(t.minting)return!0;return!1}_isMoreThanOneTokenBeingMinted(){let t=0;for(const e of this._outputs)if(H(e.minting)&&(t++,t>1))return!0;return!1}_isTheSameTokenBeingMintedOutsideTheMintingBox(){const t=this._getMintingTokenId();if(Z(t))return!1;for(const e of this._outputs)if(e.assets.contains(t))return!0;return!1}_getMintingTokenId(){let t;for(const e of this._outputs)if(e.minting){t=e.minting.tokenId;break}return t}};function Vo(t){return t.toArray!==void 0}function Pn(t){return BigInt(Ro(t))*Xr}function Ro({changeAddress:t,creationHeight:e,tokens:n,baseIndex:r,maxTokensPerBox:s}){const o=Math.ceil(n.length/s);let i=0;i+=Y(hn),i+=lt(t.ergoTree),i+=Y(e),i+=Y(0),i+=32,i=i*o;for(let l=0;l<o;l++)i+=Y(r+l);return i+=n.reduce((l,c)=>l+=lt(c.tokenId)+Y(c.amount),0),n.length>s?n.length%s>0?(i+=Y(s)*Math.floor(n.length/s),i+=Y(n.length%s)):i+=Y(s)*o:i+=Y(n.length),i}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Do=t=>t instanceof Uint8Array,Qt=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),fe=(t,e)=>t<<32-e|t>>>e,No=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!No)throw new Error("Non little-endian hardware is not supported");function Mo(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Jr(t){if(typeof t=="string"&&(t=Mo(t)),!Do(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}class jo{clone(){return this._cloneInto()}}function Go(t){const e=r=>t().update(Jr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Fo(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Hn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Qo(t,e){Fo(t);const n=e.outputLen;if(t.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}function Ko(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),l=Number(n&o),c=r?4:0,a=r?0:4;t.setUint32(e+c,i,r),t.setUint32(e+a,l,r)}class Wo extends jo{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Qt(this.buffer)}update(e){Hn(this);const{view:n,buffer:r,blockLen:s}=this;e=Jr(e);const o=e.length;for(let i=0;i<o;){const l=Math.min(s-this.pos,o-i);if(l===s){const c=Qt(e);for(;s<=o-i;i+=s)this.process(c,i);continue}r.set(e.subarray(i,i+l),this.pos),this.pos+=l,i+=l,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Hn(this),Qo(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let u=i;u<s;u++)n[u]=0;Ko(r,s-8,BigInt(this.length*8),o),this.process(r,0);const l=Qt(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=c/4,h=this.get();if(a>h.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<a;u++)l.setUint32(4*u,h[u],o)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:l}=this;return e.length=s,e.pos=l,e.finished=o,e.destroyed=i,s%n&&e.buffer.set(r),e}}const qo=(t,e,n)=>t&e^~t&n,Xo=(t,e,n)=>t&e^t&n^e&n,Zo=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Le=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ze=new Uint32Array(64);class Jo extends Wo{constructor(){super(64,32,8,!1),this.A=Le[0]|0,this.B=Le[1]|0,this.C=Le[2]|0,this.D=Le[3]|0,this.E=Le[4]|0,this.F=Le[5]|0,this.G=Le[6]|0,this.H=Le[7]|0}get(){const{A:e,B:n,C:r,D:s,E:o,F:i,G:l,H:c}=this;return[e,n,r,s,o,i,l,c]}set(e,n,r,s,o,i,l,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=l|0,this.H=c|0}process(e,n){for(let u=0;u<16;u++,n+=4)ze[u]=e.getUint32(n,!1);for(let u=16;u<64;u++){const g=ze[u-15],d=ze[u-2],p=fe(g,7)^fe(g,18)^g>>>3,f=fe(d,17)^fe(d,19)^d>>>10;ze[u]=f+ze[u-7]+p+ze[u-16]|0}let{A:r,B:s,C:o,D:i,E:l,F:c,G:a,H:h}=this;for(let u=0;u<64;u++){const g=fe(l,6)^fe(l,11)^fe(l,25),d=h+g+qo(l,c,a)+Zo[u]+ze[u]|0,f=(fe(r,2)^fe(r,13)^fe(r,22))+Xo(r,s,o)|0;h=a,a=c,c=l,l=i+d|0,i=o,o=s,s=r,r=d+f|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,l=l+this.E|0,c=c+this.F|0,a=a+this.G|0,h=h+this.H|0,this.set(r,s,o,i,l,c,a,h)}roundClean(){ze.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Yo=Go(()=>new Jo);var el=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function tl(t){Bs(t,Uint8Array);let e="";for(let n=0,r=t.length;n<r;n++)e+=el[t[n]];return e}function nl(t){Is(t,"string"),Be(t.length%2===0,"Invalid hex padding.");const e=new Uint8Array(t.length/2);for(let n=0,r=0,s=e.length;n<s;n++){const o=Ln(t.charCodeAt(r++)),i=Ln(t.charCodeAt(r++));e[n]=o*16+i}return e}function Ln(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-(65-10);if(t>=97&&t<=102)return t-(97-10);throw new Error("Invalid byte sequence.")}var Ue={encode:tl,decode:nl};kr(sl);function rl(t){return t instanceof Uint8Array?t:Ue.decode(t)}function sl(t){return Yo(rl(t))}function il(t){t.length%2&&(t="0"+t);const e=BigInt("0x"+t);return 128&parseInt(t.slice(0,2),16)?-Yr(e):e}function ol(t){const e=t>=ke;e||(t=Yr(t));let n=t.toString(16);return n.length%2&&(n="0"+n),e&&128&parseInt(n.slice(0,2),16)&&(n="00"+n),n}function Yr(t){const e=t<ke;e&&(t=-t);const n=t.toString(2);let r=n.length;const s=r%8;s>0?r+=8-s:e&&Pt(n)==="1"&&n.indexOf("1",1)!==-1&&(r+=8);const o=(1n<<BigInt(r))-1n;return(~t&o)+1n}function ll(t,e){if(e===0)return t.write(0);if(e<0)throw new RangeError("Variable Length Quantity not supported for negative numbers.");do{let n=e&127;e>>=7,e>0&&(n|=128),t.write(n)}while(e>0);return t}function Kt(t){if(t.isEmpty)return 0;let e=0,n=0,r=0;do r=t.readByte(),e|=(r&127)<<n,n+=7;while(r&128);return e}function cl(t,e){if(e===ke)return t.write(0);if(e<ke)throw new RangeError("Variable Length Quantity not supported for negative numbers");do{let n=Number(e&gr);e>>=fr,e>0&&(n|=128),t.write(n)}while(e>0);return t}function al(t){if(t.isEmpty)return ke;let e=ke,n=ke,r=ke;do r=BigInt(t.readByte()),e|=(r&gr)<<n,n+=fr;while((r&$s)!=ke);return e}function ul(t){return t<<1^t>>63}function hl(t){return t>>1^-(t&1)}function dl(t){return t<<qt^t>>Cs}function fl(t){return t>>qt^-(t&qt)}var Ie,ye,sr,gl=(sr=class{constructor(t){J(this,Ie,void 0);J(this,ye,void 0);typeof t=="string"?R(this,Ie,Ue.decode(t)):R(this,Ie,t),R(this,ye,0)}get isEmpty(){return dr(T(this,Ie))}readBoolean(){return this.readByte()===1}readBits(t){const e=new Array(t);let n=0;for(let r=0;r<t;r++){const s=T(this,Ie)[T(this,ye)]>>n++&1;e[r]=s===1,n==8&&(n=0,ne(this,ye)._++)}return n>0&&ne(this,ye)._++,e}readByte(){return T(this,Ie)[ne(this,ye)._++]}readBytes(t){return T(this,Ie).subarray(T(this,ye),R(this,ye,T(this,ye)+t))}readVlq(){return Kt(this)}readShort(){return Number(hl(Kt(this)))}readInt(){const t=this.readLong();return Number(t)}readLong(){return fl(al(this))}readBigInt(){const t=Kt(this);return il(Ue.encode(this.readBytes(t)))}},Ie=new WeakMap,ye=new WeakMap,sr),Ee,se,ir,pl=(ir=class{constructor(t){J(this,Ee,void 0);J(this,se,void 0);R(this,Ee,new Uint8Array(t)),R(this,se,0)}get length(){return T(this,se)}writeBoolean(t){return this.write(t===!0?1:0),this}writeVLQ(t){return ll(this,t)}writeBigVLQ(t){return cl(this,t)}writeShort(t){return this.writeVLQ(ul(t)),this}writeInt(t){return this.writeLong(BigInt(t)),this}writeLong(t){return this.writeBigVLQ(dl(t)),this}write(t){return T(this,Ee)[ne(this,se)._++]=t,this}writeBytes(t){return T(this,Ee).set(t,T(this,se)),R(this,se,T(this,se)+t.length),this}writeHex(t){return this.writeBytes(Ue.decode(t))}writeBits(t){let e=0;for(let n=0;n<t.length;n++)t[n]?T(this,Ee)[T(this,se)]|=1<<e++:T(this,Ee)[T(this,se)]&=~(1<<e++),e==8&&(e=0,ne(this,se)._++);return e>0&&ne(this,se)._++,this}writeBigInt(t){const e=ol(t);return this.writeVLQ(e.length/2),this.writeHex(e),this}toHex(){return Ue.encode(this.toBytes())}toBytes(){return T(this,Ee).subarray(0,T(this,se))}},Ee=new WeakMap,se=new WeakMap,ir),es=class{coerce(t){return t}},ts=class extends es{get embeddable(){return!1}},De=class extends ts{get embeddable(){return!0}},pt,or,ns=(or=class extends es{constructor(e){super();J(this,pt,void 0);R(this,pt,e)}get elementsType(){return T(this,pt)}get embeddable(){return!1}},pt=new WeakMap,or),rs=class extends De{get code(){return 1}toString(){return"SBool"}},ss=class extends De{get code(){return 2}toString(){return"SByte"}},is=class extends De{get code(){return 3}toString(){return"SShort"}},os=class extends De{get code(){return 4}toString(){return"SInt"}},ls=class extends De{get code(){return 5}coerce(t){return pr(t)}toString(){return"SLong"}},cs=class extends De{get code(){return 6}coerce(t){return pr(t)}toString(){return"SBigInt"}},as=class extends De{get code(){return 7}coerce(t){return typeof t=="string"?Ue.decode(t):t}toString(){return"SGroupElement"}},us=class extends De{get code(){return 8}toString(){return"SSigmaProp"}},hs=class extends ts{get code(){return 98}toString(){return"SUnit"}},X=Object.freeze({embeddable:0,simpleColl:1,nestedColl:2,option:3,optionCollection:4,pairOne:5,pairTwo:6,symmetricPair:7,genericTuple:8}),ds=11,nn=ds+1,pe=t=>nn*t,ml=Object.freeze({code:pe(X.simpleColl),embeddable:!1,simpleCollTypeCode:pe(X.simpleColl),nestedCollTypeCode:pe(X.nestedColl)}),yl=Object.freeze({code:pe(X.pairOne),embeddable:!1,pairOneTypeCode:pe(X.pairOne),pairTwoTypeCode:pe(X.pairTwo),tripleTypeCode:pe(X.pairTwo),symmetricPairTypeCode:pe(X.symmetricPair),quadrupleTypeCode:pe(X.symmetricPair),genericTupleTypeCode:pe(X.genericTuple)}),y={bool:new rs,byte:new ss,short:new is,int:new os,long:new ls,bigInt:new cs,groupElement:new as,sigmaProp:new us,unit:new hs,coll:ml,tuple:yl};function rn(t){return t.code>=y.coll.simpleCollTypeCode&&t.code<=y.coll.nestedCollTypeCode+ds}function fs(t){return t.code>=y.tuple.pairOneTypeCode&&t.code<=y.tuple.genericTupleTypeCode}function je(t){switch(t){case y.bool.code:return y.bool;case y.byte.code:return y.byte;case y.short.code:return y.short;case y.int.code:return y.int;case y.long.code:return y.long;case y.bigInt.code:return y.bigInt;case y.groupElement.code:return y.groupElement;case y.sigmaProp.code:return y.sigmaProp;default:throw new Error(`The type code '0x${t.toString(16)}' is not a valid primitive type code.`)}}var At=class extends ns{get code(){return y.coll.code}coerce(t){return this.elementsType.code===y.byte.code&&!(t instanceof Uint8Array)?typeof t=="string"?Ue.decode(t):Uint8Array.from(t):t.map(e=>this.elementsType.coerce(e))}toString(){return`SColl[${this.elementsType.toString()}]`}},ot=class extends ns{get code(){return y.tuple.code}coerce(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=this.elementsType[n].coerce(t[n]);return e}toString(){return`(${this.elementsType.map(t=>t.toString()).join(", ")})`}};function Ce(t,e,n){return new Proxy(t,{apply:(r,s,o)=>{const i=e??new r;return!n&&dr(o)?i:new ut(i,...o)}})}function gs(t,e){return new Proxy(t,{apply:e})}var _l=Ce(ss,y.byte);Ce(rs,y.bool);Ce(is,y.short);Ce(os,y.int);var bl=Ce(ls,y.long);Ce(cs,y.bigInt);var zn=Ce(as,y.groupElement),Un=Ce(us,y.sigmaProp);Ce(hs,void 0,!0);var wl=gs(At,(t,e,n)=>{const[r,s]=n,o=r();return s?new ut(new t(o),s):()=>new t(o)});gs(ot,(t,e,n)=>{const[r,s]=n;if(typeof r=="function"&&typeof s=="function")return()=>new t([r(),s()]);if(r instanceof ut&&s instanceof ut)return new ut(new t([r.type,s.type]),[r.data,s.data]);throw new Error("Invalid tuple declaration.")});var vl=33,Vn=205,Rn=class Ct{static serialize(e,n,r){if(n.embeddable)switch(n.code){case y.bool.code:return r.writeBoolean(e);case y.byte.code:return r.write(e);case y.short.code:return r.writeShort(e);case y.int.code:return r.writeInt(e);case y.long.code:return r.writeLong(e);case y.bigInt.code:return r.writeBigInt(e);case y.groupElement.code:return r.writeBytes(e);case y.sigmaProp.code:{const s=e;if(s.type===y.groupElement)return r.write(Vn),Ct.serialize(s.data,s.type,r);throw Error("Serialization error: SigmaProp operation not implemented.")}}else if(rn(n)){if(n.elementsType.code===y.byte.code){const s=e instanceof Uint8Array;Be(s,`SColl[Byte] expected an UInt8Array, got ${typeof e}.`)}else Be(Array.isArray(e),`SColl expected an array, got ${typeof e}.`);switch(r.writeVLQ(e.length),n.elementsType.code){case y.bool.code:return r.writeBits(e);case y.byte.code:return r.writeBytes(e);default:{for(let s=0;s<e.length;s++)Ct.serialize(e[s],n.elementsType,r);return r}}}else if(fs(n)){Be(Array.isArray(e),`STupleType serialization expected an array, got ${typeof e}.`);const s=n.elementsType.length;for(let o=0;o<s;o++)Ct.serialize(e[o],n.elementsType[o],r);return r}else if(n.code===y.unit.code)return r;throw Error(`Serialization error: '0x${n.code.toString(16)}' type not implemented.`)}static deserialize(e,n){if(e.embeddable)switch(e.code){case y.bool.code:return n.readBoolean();case y.byte.code:return n.readByte();case y.short.code:return n.readShort();case y.int.code:return n.readInt();case y.long.code:return n.readLong();case y.bigInt.code:return n.readBigInt();case y.groupElement.code:return n.readBytes(vl);case y.sigmaProp.code:{if(n.readByte()===Vn)return this.deserialize(y.groupElement,n);break}}else switch(e.code){case y.coll.code:{const r=n.readVlq(),s=e.elementsType;switch(s.code){case y.bool.code:return n.readBits(r);case y.byte.code:return n.readBytes(r);default:{const o=new Array(r);for(let i=0;i<r;i++)o[i]=this.deserialize(s,n);return o}}}case y.tuple.code:return e.elementsType.map(r=>this.deserialize(r,n));case y.unit.code:return}throw new Error(`Parsing error: '0x${e.code.toString(16)}' type not implemented.`)}},Dn=class{static serialize(t,e){if(t.embeddable)e.write(t.code);else if(t.code===y.unit.code)e.write(t.code);else if(rn(t))if(t.elementsType.embeddable)e.write(y.coll.simpleCollTypeCode+t.elementsType.code);else if(rn(t.elementsType)){const n=t.elementsType;n.elementsType.embeddable?e.write(y.coll.nestedCollTypeCode+n.elementsType.code):(e.write(y.coll.simpleCollTypeCode),this.serialize(n,e))}else e.write(y.coll.simpleCollTypeCode),this.serialize(t.elementsType,e);else if(fs(t)){switch(t.elementsType.length){case 2:{const n=Pt(t.elementsType),r=Ss(t.elementsType);n.embeddable?n.code===r.code?e.write(y.tuple.symmetricPairTypeCode+n.code):(e.write(y.tuple.pairOneTypeCode+n.code),this.serialize(r,e)):r.embeddable?(e.write(y.tuple.pairTwoTypeCode+r.code),this.serialize(n,e)):(e.write(y.tuple.pairOneTypeCode),this.serialize(n,e),this.serialize(r,e));return}case 3:e.write(y.tuple.tripleTypeCode);break;case 4:e.write(y.tuple.quadrupleTypeCode);break;default:{const n=t.elementsType.length;Be(n>=2&&n<=255,"Invalid type: tuples must have between 2 and 255 items."),e.write(y.tuple.genericTupleTypeCode),e.writeVLQ(n)}}for(let n=0;n<t.elementsType.length;n++)this.serialize(t.elementsType[n],e)}else throw new Error("Serialization error: type not implemented.")}static deserialize(t){const e=t.readByte();if(Be(e>0,`Parsing Error: Unexpected type code '0x${e.toString(16)}'`),e<y.tuple.genericTupleTypeCode){const n=Math.floor(e/nn),r=Math.floor(e%nn);switch(n){case X.embeddable:return je(r);case X.simpleColl:{const s=r===0?this.deserialize(t):je(r);return new At(s)}case X.nestedColl:return new At(new At(je(r)));case X.pairOne:{const s=r===0?[this.deserialize(t),this.deserialize(t)]:[je(r),this.deserialize(t)];return new ot(s)}case X.pairTwo:{const s=r===0?[this.deserialize(t),this.deserialize(t),this.deserialize(t)]:[this.deserialize(t),je(r)];return new ot(s)}case X.symmetricPair:{const s=r===0?[this.deserialize(t),this.deserialize(t),this.deserialize(t),this.deserialize(t)]:[je(r),je(r)];return new ot(s)}}}else switch(e){case y.tuple.genericTupleTypeCode:{const n=t.readVlq(),r=new Array(n);for(let s=0;s<n;s++)r[s]=this.deserialize(t);return new ot(r)}case y.unit.code:return y.unit}throw new Error("Not implemented.")}},xl=4096,mt,yt,_t,ut=(_t=class{constructor(e,n){J(this,mt,void 0);J(this,yt,void 0);R(this,mt,e),R(this,yt,e.coerce(n))}static from(e){Be(e.length>0,"Empty constant bytes.");const n=new gl(e),r=Dn.deserialize(n),s=Rn.deserialize(r,n);return new _t(r,s)}get type(){return T(this,mt)}get data(){return T(this,yt)}toBytes(){const e=new pl(xl);return Dn.serialize(this.type,e),Rn.serialize(this.data,this.type,e),e.toBytes()}toHex(){return Ue.encode(this.toBytes())}},mt=new WeakMap,yt=new WeakMap,_t);function Tl(t,e,n,r,s,o,i){const l=we.fromBase58(e),c=we.fromBase58(s),a=new Fe(hn,t).addTokens(o).setAdditionalRegisters({R4:bl(i).toHex(),R5:Un(zn(Pt(l.getPublicKeys()))).toHex(),R6:Un(zn(Pt(c.getPublicKeys()))).toHex()});return new Zr(r).from(n).to(a).sendChangeTo(l).payFee(dn).build().toEIP12Object()}function Nn(t,e,n){const r=t.slice();return r[18]=e[n],r}function Mn(t,e,n){const r=t.slice();return r[18]=e[n],r[21]=e,r[22]=n,r}function jn(t){let e,n,r=t[18].tokenId.substr(0,3)+"",s,o,i=t[18].tokenId.substr(t[18].tokenId.length-3,t[18].tokenId.length-1)+"",l,c,a,h,u,g,d="remove",p,f,w;function C(){t[9].call(h,t[21],t[22])}function I(){return t[10](t[18])}return{c(){e=S("div"),n=S("div"),s=N(r),o=N("..."),l=N(i),c=G(),a=S("div"),h=S("input"),u=G(),g=S("button"),g.textContent=d,p=G(),this.h()},l(k){e=A(k,"DIV",{class:!0});var z=O(e);n=A(z,"DIV",{class:!0});var E=O(n);s=M(E,r),o=M(E,"..."),l=M(E,i),E.forEach(x),c=F(z),a=A(z,"DIV",{});var L=O(a);h=A(L,"INPUT",{class:!0,type:!0,min:!0}),L.forEach(x),u=F(z),g=A(z,"BUTTON",{"data-svelte-h":!0}),bt(g)!=="svelte-1exm36t"&&(g.textContent=d),p=F(z),z.forEach(x),this.h()},h(){B(n,"class","font-mono"),B(h,"class","p-2 py-1"),B(h,"type","number"),B(h,"min","1"),B(e,"class","w-full flex items-center gap-2 px-2 py-1")},m(k,z){te(k,e,z),b(e,n),b(n,s),b(n,o),b(n,l),b(e,c),b(e,a),b(a,h),$t(h,t[18].amount),b(e,u),b(e,g),b(e,p),f||(w=[Qe(h,"input",C),Qe(g,"click",I)],f=!0)},p(k,z){t=k,z&4&&r!==(r=t[18].tokenId.substr(0,3)+"")&&le(s,r),z&4&&i!==(i=t[18].tokenId.substr(t[18].tokenId.length-3,t[18].tokenId.length-1)+"")&&le(l,i),z&4&&cr(h.value)!==t[18].amount&&$t(h,t[18].amount)},d(k){k&&x(e),f=!1,lr(w)}}}function Il(t){let e;return{c(){e=N("+")},l(n){e=M(n,"+")},m(n,r){te(n,e,r)},d(n){n&&x(e)}}}function El(t){let e;return{c(){e=N("-")},l(n){e=M(n,"-")},m(n,r){te(n,e,r)},d(n){n&&x(e)}}}function Gn(t){let e,n=ce(t[1]),r=[];for(let s=0;s<n.length;s+=1)r[s]=Fn(Nn(t,n,s));return{c(){e=S("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=A(s,"DIV",{class:!0});var o=O(e);for(let i=0;i<r.length;i+=1)r[i].l(o);o.forEach(x),this.h()},h(){B(e,"class","w-full assets mt-4 svelte-ghemqt")},m(s,o){te(s,e,o);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null)},p(s,o){if(o&34){n=ce(s[1]);let i;for(i=0;i<n.length;i+=1){const l=Nn(s,n,i);r[i]?r[i].p(l,o):(r[i]=Fn(l),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(s){s&&x(e),rt(r,s)}}}function Fn(t){let e,n,r=t[18].tokenId.substr(0,3)+"",s,o,i=t[18].tokenId.substr(t[18].tokenId.length-3,t[18].tokenId.length-1)+"",l,c,a,h=t[18].amount+"",u,g,d,p;function f(){return t[12](t[18])}return{c(){e=S("button"),n=S("div"),s=N(r),o=N("..."),l=N(i),c=G(),a=S("div"),u=N(h),g=G(),this.h()},l(w){e=A(w,"BUTTON",{class:!0});var C=O(e);n=A(C,"DIV",{class:!0});var I=O(n);s=M(I,r),o=M(I,"..."),l=M(I,i),I.forEach(x),c=F(C),a=A(C,"DIV",{});var k=O(a);u=M(k,h),k.forEach(x),g=F(C),C.forEach(x),this.h()},h(){B(n,"class","font-mono"),B(e,"class","px-2 py-1 w-full flex justify-between gap-2 svelte-ghemqt")},m(w,C){te(w,e,C),b(e,n),b(n,s),b(n,o),b(n,l),b(e,c),b(e,a),b(a,u),b(e,g),d||(p=Qe(e,"click",f),d=!0)},p(w,C){t=w,C&2&&r!==(r=t[18].tokenId.substr(0,3)+"")&&le(s,r),C&2&&i!==(i=t[18].tokenId.substr(t[18].tokenId.length-3,t[18].tokenId.length-1)+"")&&le(l,i),C&2&&h!==(h=t[18].amount+"")&&le(u,h)},d(w){w&&x(e),d=!1,p()}}}function kl(t){let e,n,r,s,o,i,l,c,a,h,u,g,d,p="sell",f,w,C,I=ce(t[2]),k=[];for(let $=0;$<I.length;$+=1)k[$]=jn(Mn(t,I,$));function z($,U){return $[0]?El:Il}let E=z(t),L=E(t),D=t[0]&&Gn(t);return{c(){e=S("div"),n=S("div");for(let $=0;$<k.length;$+=1)k[$].c();r=G(),s=S("div"),o=S("button"),L.c(),i=N(`
			add tokens`),l=G(),c=S("div"),a=S("div"),h=S("input"),u=G(),g=S("div"),d=S("button"),d.textContent=p,f=G(),D&&D.c(),this.h()},l($){e=A($,"DIV",{class:!0});var U=O(e);n=A(U,"DIV",{class:!0});var V=O(n);for(let Vt=0;Vt<k.length;Vt+=1)k[Vt].l(V);V.forEach(x),r=F(U),s=A(U,"DIV",{class:!0});var he=O(s);o=A(he,"BUTTON",{class:!0});var ve=O(o);L.l(ve),i=M(ve,`
			add tokens`),ve.forEach(x),l=F(he),c=A(he,"DIV",{class:!0,style:!0});var wt=O(c);a=A(wt,"DIV",{});var fn=O(a);h=A(fn,"INPUT",{class:!0,type:!0,placeholder:!0}),fn.forEach(x),u=F(wt),g=A(wt,"DIV",{class:!0});var gn=O(g);d=A(gn,"BUTTON",{class:!0,"data-svelte-h":!0}),bt(d)!=="svelte-1jkvvon"&&(d.textContent=p),gn.forEach(x),wt.forEach(x),he.forEach(x),f=F(U),D&&D.l(U),U.forEach(x),this.h()},h(){B(n,"class","w-full flex flex-col my-2"),B(o,"class","grow p-4"),B(h,"class","p-2 w-full"),B(h,"type","text"),B(h,"placeholder","Price in ERG"),B(d,"class","btn p-4"),B(g,"class","flex flex-col justify-end"),B(c,"class","flex flex-col gap-2 justify-end"),sn(c,"width","180px"),B(s,"class","w-full flex"),B(e,"class","mt-4 p-4 box w-full flex flex-wrap backdrop-blur-md bg-opacity-10 shadow-sm svelte-ghemqt")},m($,U){te($,e,U),b(e,n);for(let V=0;V<k.length;V+=1)k[V]&&k[V].m(n,null);b(e,r),b(e,s),b(s,o),L.m(o,null),b(o,i),b(s,l),b(s,c),b(c,a),b(a,h),$t(h,t[3]),b(c,u),b(c,g),b(g,d),b(e,f),D&&D.m(e,null),w||(C=[Qe(o,"click",t[4]),Qe(h,"input",t[11]),Qe(d,"click",t[7])],w=!0)},p($,[U]){if(U&68){I=ce($[2]);let V;for(V=0;V<I.length;V+=1){const he=Mn($,I,V);k[V]?k[V].p(he,U):(k[V]=jn(he),k[V].c(),k[V].m(n,null))}for(;V<k.length;V+=1)k[V].d(1);k.length=I.length}E!==(E=z($))&&(L.d(1),L=E($),L&&(L.c(),L.m(o,i))),U&8&&h.value!==$[3]&&$t(h,$[3]),$[0]?D?D.p($,U):(D=Gn($),D.c(),D.m(e,null)):D&&(D.d(1),D=null)},i:be,o:be,d($){$&&x(e),rt(k,$),L.d(),D&&D.d(),w=!1,lr(C)}}}function Bl(t,e){return t.some(n=>n.tokenId==e.tokenId)?(t.find(n=>n.tokenId==e.tokenId).amount+=e.amount,t):[...t,e]}function Sl(t,e,n){let r,s,o,i;Ge(t,hr,E=>n(8,r=E)),Ge(t,Wt,E=>n(13,s=E)),Ge(t,mn,E=>n(14,o=E)),Ge(t,yn,E=>n(15,i=E));let l=!1,c=[],a=[],h;async function u(){var E;if(!r||!((E=window.ergoConnector[r])!=null&&E.isConnected)){_s("Please connect a wallet.",1500);return}n(0,l=!l),l||g(r)}async function g(E){var L;if((L=window.ergoConnector[E])!=null&&L.isConnected){const D=await ergo.get_utxos();mn.set(JSON.parse(JSON.stringify(D))),yn.set(D.flatMap($=>$.assets.map(U=>(U.amount=BigInt(U.amount),U))).reduce(Bl,[])),n(1,c=i.filter($=>!a.some(U=>U.tokenId==$.tokenId)))}}function d(E){n(1,c=c.filter(L=>L.tokenId!=E.tokenId)),n(2,a=[...a,Object.assign({},E)])}function p(E){n(1,c=[i.find(L=>L.tokenId==E.tokenId),...c]),n(2,a=a.filter(L=>L.tokenId!=E.tokenId))}function f(){n(0,l=!1),n(2,a=[])}async function w(){var he;if(!r||!((he=window.ergoConnector[r])!=null&&he.isConnected)){It("Connect a wallet.",1500);return}if(a.length<1){It("Add Tokens.",1500);return}if(h==null){It("Set a price.",1500);return}const E=await ergo.get_change_address(),L=await ergo.get_current_height(),D=Tl(ws,E,o,L,bs,a,BigInt(h*10**9)),$=await ergo.sign_tx(D),U=await ergo.submit_tx($),V={tokens:JSON.parse(JSON.stringify(a.map(ve=>({tokenId:ve.tokenId,amount:ve.amount.toString()})))),seller:E,tx:$,transactionId:U,priceInErg:h};Wt.update(ve=>(ve.push(V),ve)),localStorage.setItem("ergo_bay_unconfirmed_sales",JSON.stringify(s)),f()}function C(E,L){E[L].amount=cr(this.value),n(2,a)}const I=E=>p(E);function k(){h=this.value,n(3,h)}const z=E=>d(E);return t.$$.update=()=>{t.$$.dirty&256&&g(r)},[l,c,a,h,u,d,p,w,r,C,I,k,z]}class Al extends qe{constructor(e){super(),Xe(this,e,Sl,kl,We,{})}}const Qn=100n;async function Cl(t,e,n,r,s,o,i){const l=we.fromBase58(e),c=new Fe(s-s/Qn,o).setAdditionalRegisters({R4:wl(_l,t.boxId).toHex()}),a=new Fe(s/Qn,i);return new Zr(r).configureSelector(u=>u.ensureInclusion(t.boxId)).from([t,...n]).to([c,a]).sendChangeTo(l).payFee(dn).build().toEIP12Object()}function Kn(t,e,n){const r=t.slice();return r[3]=e[n],r}function Wn(t){let e,n,r=t[3].tokenId.substr(0,3)+"",s,o,i=t[3].tokenId.substr(t[3].tokenId.length-3,t[3].tokenId.length-1)+"",l,c,a,h=t[3].amount+"",u,g;return{c(){e=S("div"),n=S("div"),s=N(r),o=N("..."),l=N(i),c=G(),a=S("div"),u=N(h),g=G(),this.h()},l(d){e=A(d,"DIV",{class:!0});var p=O(e);n=A(p,"DIV",{class:!0});var f=O(n);s=M(f,r),o=M(f,"..."),l=M(f,i),f.forEach(x),c=F(p),a=A(p,"DIV",{});var w=O(a);u=M(w,h),w.forEach(x),g=F(p),p.forEach(x),this.h()},h(){B(n,"class","font-mono"),B(e,"class","flex gap-2")},m(d,p){te(d,e,p),b(e,n),b(n,s),b(n,o),b(n,l),b(e,c),b(e,a),b(a,u),b(e,g)},p(d,p){p&1&&r!==(r=d[3].tokenId.substr(0,3)+"")&&le(s,r),p&1&&i!==(i=d[3].tokenId.substr(d[3].tokenId.length-3,d[3].tokenId.length-1)+"")&&le(l,i),p&1&&h!==(h=d[3].amount+"")&&le(u,h)},d(d){d&&x(e)}}}function $l(t){let e,n,r,s,o,i=t[0].additionalRegisters.R4.renderedValue/1e9+"",l,c,a,h,u="buy",g,d,p=ce(t[0].assets),f=[];for(let w=0;w<p.length;w+=1)f[w]=Wn(Kn(t,p,w));return{c(){e=S("div"),n=S("div");for(let w=0;w<f.length;w+=1)f[w].c();r=G(),s=S("div"),o=S("div"),l=N(i),c=N(" ERG"),a=G(),h=S("button"),h.textContent=u,this.h()},l(w){e=A(w,"DIV",{class:!0});var C=O(e);n=A(C,"DIV",{class:!0});var I=O(n);for(let E=0;E<f.length;E+=1)f[E].l(I);I.forEach(x),r=F(C),s=A(C,"DIV",{class:!0,style:!0});var k=O(s);o=A(k,"DIV",{class:!0});var z=O(o);l=M(z,i),c=M(z," ERG"),z.forEach(x),a=F(k),h=A(k,"BUTTON",{class:!0,"data-svelte-h":!0}),bt(h)!=="svelte-2qsv9b"&&(h.textContent=u),k.forEach(x),C.forEach(x),this.h()},h(){B(n,"class","grow flex flex-col justify-center"),B(o,"class","p-4 pt-1 text-center"),B(h,"class","btn-secondary p-4"),B(s,"class","flex flex-col justify-end"),sn(s,"min-width","180px"),B(e,"class","p-4 box w-full flex flex-wrap backdrop-blur-md bg-opacity-10 shadow-sm svelte-pwleuc")},m(w,C){te(w,e,C),b(e,n);for(let I=0;I<f.length;I+=1)f[I]&&f[I].m(n,null);b(e,r),b(e,s),b(s,o),b(o,l),b(o,c),b(s,a),b(s,h),g||(d=Qe(h,"click",t[1]),g=!0)},p(w,[C]){if(C&1){p=ce(w[0].assets);let I;for(I=0;I<p.length;I+=1){const k=Kn(w,p,I);f[I]?f[I].p(k,C):(f[I]=Wn(k),f[I].c(),f[I].m(n,null))}for(;I<f.length;I+=1)f[I].d(1);f.length=p.length}C&1&&i!==(i=w[0].additionalRegisters.R4.renderedValue/10**9+"")&&le(l,i)},i:be,o:be,d(w){w&&x(e),rt(f,w),g=!1,d()}}}function Ol(t,e,n){let r;Ge(t,hr,i=>n(2,r=i));let{offer:s}=e;async function o(){var w;if(!r||!((w=window.ergoConnector[r])!=null&&w.isConnected)){It("Connect a wallet.",1500);return}const i=await ergo.get_change_address(),l=await ergo.get_utxos(),c=await ergo.get_current_height(),a=BigInt(s.additionalRegisters.R4.renderedValue),h=we.fromPublicKey(s.additionalRegisters.R5.serializedValue.substring(4)).toString(),u=we.fromPublicKey(s.additionalRegisters.R6.serializedValue.substring(4)).toString();let g=JSON.parse(JSON.stringify(s));for(const[C,I]of Object.entries(g.additionalRegisters))g.additionalRegisters[C]=I.serializedValue;const d=await Cl(g,i,l,c,a,h,u),p=await ergo.sign_tx(d),f=await ergo.submit_tx(p);console.log(f)}return t.$$set=i=>{"offer"in i&&n(0,s=i.offer)},[s,o]}class Pl extends qe{constructor(e){super(),Xe(this,e,Ol,$l,We,{offer:0})}}function qn(t,e,n){const r=t.slice();return r[1]=e[n],r}function Xn(t){let e,n;return e=new Pl({props:{offer:t[1]}}),{c(){Ye(e.$$.fragment)},l(r){et(e.$$.fragment,r)},m(r,s){tt(e,r,s),n=!0},p(r,s){const o={};s&1&&(o.offer=r[1]),e.$set(o)},i(r){n||(ie(e.$$.fragment,r),n=!0)},o(r){ae(e.$$.fragment,r),n=!1},d(r){nt(e,r)}}}function Hl(t){let e,n,r=ce(t[0]),s=[];for(let i=0;i<r.length;i+=1)s[i]=Xn(qn(t,r,i));const o=i=>ae(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=Ot()},l(i){for(let l=0;l<s.length;l+=1)s[l].l(i);e=Ot()},m(i,l){for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(i,l);te(i,e,l),n=!0},p(i,[l]){if(l&1){r=ce(i[0]);let c;for(c=0;c<r.length;c+=1){const a=qn(i,r,c);s[c]?(s[c].p(a,l),ie(s[c],1)):(s[c]=Xn(a),s[c].c(),ie(s[c],1),s[c].m(e.parentNode,e))}for(ar(),c=r.length;c<s.length;c+=1)o(c);ur()}},i(i){if(!n){for(let l=0;l<r.length;l+=1)ie(s[l]);n=!0}},o(i){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)ae(s[l]);n=!1},d(i){i&&x(e),rt(s,i)}}}function Ll(t,e,n){let r;return Ge(t,vs,s=>n(0,r=s)),[r]}class zl extends qe{constructor(e){super(),Xe(this,e,Ll,Hl,We,{})}}function Zn(t,e,n){const r=t.slice();return r[1]=e[n],r}function Jn(t){let e,n,r=t[1].tokenId.substr(0,3)+"",s,o,i=t[1].tokenId.substr(t[1].tokenId.length-3,t[1].tokenId.length-1)+"",l,c,a,h=t[1].amount+"",u,g;return{c(){e=S("div"),n=S("div"),s=N(r),o=N("..."),l=N(i),c=G(),a=S("div"),u=N(h),g=G(),this.h()},l(d){e=A(d,"DIV",{class:!0});var p=O(e);n=A(p,"DIV",{class:!0});var f=O(n);s=M(f,r),o=M(f,"..."),l=M(f,i),f.forEach(x),c=F(p),a=A(p,"DIV",{});var w=O(a);u=M(w,h),w.forEach(x),g=F(p),p.forEach(x),this.h()},h(){B(n,"class","font-mono"),B(e,"class","flex gap-2")},m(d,p){te(d,e,p),b(e,n),b(n,s),b(n,o),b(n,l),b(e,c),b(e,a),b(a,u),b(e,g)},p(d,p){p&1&&r!==(r=d[1].tokenId.substr(0,3)+"")&&le(s,r),p&1&&i!==(i=d[1].tokenId.substr(d[1].tokenId.length-3,d[1].tokenId.length-1)+"")&&le(l,i),p&1&&h!==(h=d[1].amount+"")&&le(u,h)},d(d){d&&x(e)}}}function Ul(t){let e,n,r,s,o,i="confirming...",l,c,a,h,u=ce(t[0].tokens),g=[];for(let d=0;d<u.length;d+=1)g[d]=Jn(Zn(t,u,d));return{c(){e=S("div"),n=S("div");for(let d=0;d<g.length;d+=1)g[d].c();r=G(),s=S("div"),o=S("div"),o.textContent=i,l=G(),c=S("a"),a=N("Transaction ID"),this.h()},l(d){e=A(d,"DIV",{class:!0});var p=O(e);n=A(p,"DIV",{class:!0});var f=O(n);for(let I=0;I<g.length;I+=1)g[I].l(f);f.forEach(x),r=F(p),s=A(p,"DIV",{class:!0});var w=O(s);o=A(w,"DIV",{"data-svelte-h":!0}),bt(o)!=="svelte-1g0mdkw"&&(o.textContent=i),l=F(w),c=A(w,"A",{target:!0,href:!0,class:!0});var C=O(c);a=M(C,"Transaction ID"),C.forEach(x),w.forEach(x),p.forEach(x),this.h()},h(){B(n,"class","grow flex flex-col justify-center"),B(c,"target","_blank"),B(c,"href",h="https://explorer.ergoplatform.com/en/transactions/"+t[0].transactionId),B(c,"class","underline"),B(s,"class",""),B(e,"class","p-4 box w-full flex flex-wrap backdrop-blur-md bg-opacity-10 shadow-sm svelte-1d6z76h")},m(d,p){te(d,e,p),b(e,n);for(let f=0;f<g.length;f+=1)g[f]&&g[f].m(n,null);b(e,r),b(e,s),b(s,o),b(s,l),b(s,c),b(c,a)},p(d,[p]){if(p&1){u=ce(d[0].tokens);let f;for(f=0;f<u.length;f+=1){const w=Zn(d,u,f);g[f]?g[f].p(w,p):(g[f]=Jn(w),g[f].c(),g[f].m(n,null))}for(;f<g.length;f+=1)g[f].d(1);g.length=u.length}p&1&&h!==(h="https://explorer.ergoplatform.com/en/transactions/"+d[0].transactionId)&&B(c,"href",h)},i:be,o:be,d(d){d&&x(e),rt(g,d)}}}function Vl(t,e,n){let{sale:r}=e;return t.$$set=s=>{"sale"in s&&n(0,r=s.sale)},[r]}class Rl extends qe{constructor(e){super(),Xe(this,e,Vl,Ul,We,{sale:0})}}function Yn(t,e,n){const r=t.slice();return r[1]=e[n],r}function er(t){let e,n;return e=new Rl({props:{sale:t[1]}}),{c(){Ye(e.$$.fragment)},l(r){et(e.$$.fragment,r)},m(r,s){tt(e,r,s),n=!0},p(r,s){const o={};s&1&&(o.sale=r[1]),e.$set(o)},i(r){n||(ie(e.$$.fragment,r),n=!0)},o(r){ae(e.$$.fragment,r),n=!1},d(r){nt(e,r)}}}function Dl(t){let e,n,r=ce(t[0]),s=[];for(let i=0;i<r.length;i+=1)s[i]=er(Yn(t,r,i));const o=i=>ae(s[i],1,1,()=>{s[i]=null});return{c(){for(let i=0;i<s.length;i+=1)s[i].c();e=Ot()},l(i){for(let l=0;l<s.length;l+=1)s[l].l(i);e=Ot()},m(i,l){for(let c=0;c<s.length;c+=1)s[c]&&s[c].m(i,l);te(i,e,l),n=!0},p(i,[l]){if(l&1){r=ce(i[0]);let c;for(c=0;c<r.length;c+=1){const a=Yn(i,r,c);s[c]?(s[c].p(a,l),ie(s[c],1)):(s[c]=er(a),s[c].c(),ie(s[c],1),s[c].m(e.parentNode,e))}for(ar(),c=r.length;c<s.length;c+=1)o(c);ur()}},i(i){if(!n){for(let l=0;l<r.length;l+=1)ie(s[l]);n=!0}},o(i){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)ae(s[l]);n=!1},d(i){i&&x(e),rt(s,i)}}}function Nl(t,e,n){let r;return Ge(t,Wt,s=>n(0,r=s)),[r]}class Ml extends qe{constructor(e){super(),Xe(this,e,Nl,Dl,We,{})}}function jl(t){let e,n,r,s,o,i,l;return n=new Al({}),s=new Ml({}),i=new zl({}),{c(){e=S("div"),Ye(n.$$.fragment),r=G(),Ye(s.$$.fragment),o=G(),Ye(i.$$.fragment),this.h()},l(c){e=A(c,"DIV",{class:!0,style:!0});var a=O(e);et(n.$$.fragment,a),r=F(a),et(s.$$.fragment,a),o=F(a),et(i.$$.fragment,a),a.forEach(x),this.h()},h(){B(e,"class","bg-main grow flex flex-col items-center gap-5 svelte-17tiq0i"),sn(e,"padding-top","80px")},m(c,a){te(c,e,a),tt(n,e,null),b(e,r),tt(s,e,null),b(e,o),tt(i,e,null),l=!0},p:be,i(c){l||(ie(n.$$.fragment,c),ie(s.$$.fragment,c),ie(i.$$.fragment,c),l=!0)},o(c){ae(n.$$.fragment,c),ae(s.$$.fragment,c),ae(i.$$.fragment,c),l=!1},d(c){c&&x(e),nt(n),nt(s),nt(i)}}}class Gl extends qe{constructor(e){super(),Xe(this,e,null,jl,We,{})}}function Fl(t){let e,n;return e=new Gl({}),{c(){Ye(e.$$.fragment)},l(r){et(e.$$.fragment,r)},m(r,s){tt(e,r,s),n=!0},i(r){n||(ie(e.$$.fragment,r),n=!0)},o(r){ae(e.$$.fragment,r),n=!1},d(r){nt(e,r)}}}function Ql(t){let e,n='<img class="unselectable" src="ship.png" style="width:250px;" alt=""/> <div class="font-mono mt-4">loading...</div>';return{c(){e=S("div"),e.innerHTML=n,this.h()},l(r){e=A(r,"DIV",{class:!0,"data-svelte-h":!0}),bt(e)!=="svelte-83we0i"&&(e.innerHTML=n),this.h()},h(){B(e,"class","grow flex flex-col items-center justify-center")},m(r,s){te(r,e,s)},i:be,o:be,d(r){r&&x(e)}}}function Kl(t){let e,n,r,s;const o=[Ql,Fl],i=[];function l(c,a){return 1}return n=l(),r=i[n]=o[n](t),{c(){e=S("div"),r.c(),this.h()},l(c){e=A(c,"DIV",{class:!0});var a=O(e);r.l(a),a.forEach(x),this.h()},h(){B(e,"class","h-full flex flex-col grow main-page svelte-7vxakv")},m(c,a){te(c,e,a),i[n].m(e,null),s=!0},p:be,i(c){s||(ie(r),s=!0)},o(c){ae(r),s=!1},d(c){c&&x(e),i[n].d()}}}function Wl(t){ys(e);function e(){xs(),Ts()}return[]}class wc extends qe{constructor(e){super(),Xe(this,e,Wl,Kl,We,{})}}export{wc as component};
